<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>财务报表 - 退款订单列表</title>
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/sidebar.css">
</head>
<body>
    <!-- 左侧菜单导航栏 -->
    <div id="sidebar-container">
        <!-- 侧边栏组件将在这里加载 -->
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 顶部导航栏 -->
        <div id="top-nav-container">
            <!-- 顶部导航栏组件将在这里加载 -->
        </div>

        <!-- 页面内容 -->
        <div class="page-content">
            <!-- 面包屑导航 -->
            <div class="breadcrumb">
                <!-- 面包屑导航将在这里动态生成 -->
            </div>

            <!-- 内容容器 -->
            <div id="content-container">
                <div class="container">
                    <!-- 查询条件区域 -->
                    <div class="card">
                        <div class="card-title">查询条件</div>
                        <form class="form-grid">
                            <div class="form-group">
                                <label>订单号</label>
                                <input type="text" placeholder="请输入订单号">
                            </div>
                            <div class="form-group">
                                <label>专业</label>
                                <input type="text" placeholder="请输入专业名称">
                            </div>
                            <div class="form-group">
                                <label>科目</label>
                                <select>
                                    <option value="">请选择科目</option>
                                    <option value="1">计算机科学与技术</option>
                                    <option value="2">软件工程</option>
                                    <option value="3">数据科学</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>课程名称</label>
                                <input type="text" placeholder="请输入课程名称">
                            </div>
                            <div class="form-group">
                                <label>课程状态</label>
                                <select>
                                    <option value="">请选择状态</option>
                                    <option value="1">进行中</option>
                                    <option value="2">已完成</option>
                                    <option value="3">已取消</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>学员信息</label>
                                <input type="text" placeholder="姓名/手机号/身份证">
                            </div>
                            <div class="form-group">
                                <label>支付方式</label>
                                <select>
                                    <option value="">请选择支付方式</option>
                                    <option value="1">微信支付</option>
                                    <option value="2">聚合支付</option>
                                    <option value="3">余额支付</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>支付状态</label>
                                <select>
                                    <option value="">请选择支付状态</option>
                                    <option value="1">支付成功</option>
                                    <option value="2">支付失败</option>
                                    <option value="3">待支付</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>支付时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>订单时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>退款时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>课程类型</label>
                                <select>
                                    <option value="">请选择课程类型</option>
                                    <option value="1">在线课程</option>
                                    <option value="2">面授课程</option>
                                    <option value="3">混合课程</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>结算状态</label>
                                <select>
                                    <option value="">请选择结算状态</option>
                                    <option value="1">未结算</option>
                                    <option value="2">已结算</option>
                                    <option value="3">结算中</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>结算单号</label>
                                <input type="text" placeholder="请输入结算单号">
                            </div>
                            <div class="form-group">
                                <label>结算单生成时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="button" class="btn btn-primary">查询</button>
                                <button type="button" class="btn btn-secondary">重置</button>
                            </div>
                        </form>
                    </div>

                    <!-- 操作按钮区域 -->
                    <div class="action-section">
                        <div class="action-left">
                            <button class="btn btn-warning" onclick="exportData()">导出数据</button>
                            <button class="btn btn-info" onclick="showExportRecordsModal()">查看导出记录</button>
                        </div>
                        <div>
                            <span style="color: #666; font-size: 14px;">
                                退款订单：<strong style="color: #fa8c16;">76</strong> 条
                            </span>
                        </div>
                    </div>

                    <!-- 表格区域 -->
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">退款订单列表</div>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>订单号</th>
                                        <th>学员名称</th>
                                        <th>手机号</th>
                                        <th>课程名称</th>
                                        <th>课程类型</th>
                                        <th>有效类型</th>
                                        <th>有效结束时间</th>
                                        <th>订单时间</th>
                                        <th>冻结状态</th>
                                        <th>支付状态</th>
                                        <th>发票状态</th>
                                        <th>课程学时</th>
                                        <th>订单金额</th>
                                        <th>实付金额</th>
                                        <th>支付时间</th>
                                        <th>退款时间</th>
                                        <th>支付方式</th>
                                        <th>结算状态</th>
                                        <th>结算单号</th>
                                        <th>结算单生成时间</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>ORD20231201006</td>
                                        <td>孙八</td>
                                        <td>134****1111</td>
                                        <td>Java基础入门</td>
                                        <td>在线课程</td>
                                        <td>永久有效</td>
                                        <td>-</td>
                                        <td>2023-12-01 10:15:30</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-invoice">已开票</span></td>
                                        <td>60学时</td>
                                        <td>¥1,500.00</td>
                                        <td>¥1,200.00</td>
                                        <td>2023-12-01 10:20:15</td>
                                        <td>2023-12-05 14:30:20</td>
                                        <td>微信支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>ORD20231201007</td>
                                        <td>周九</td>
                                        <td>133****2222</td>
                                        <td>Python编程基础</td>
                                        <td>面授课程</td>
                                        <td>一年有效</td>
                                        <td>2024-12-01</td>
                                        <td>2023-12-02 09:25:10</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>80学时</td>
                                        <td>¥2,000.00</td>
                                        <td>¥1,800.00</td>
                                        <td>2023-12-02 09:30:45</td>
                                        <td>2023-12-06 16:20:30</td>
                                        <td>聚合支付</td>
                                        <td><span class="status-badge status-success">已结算</span></td>
                                        <td>JS20231201003</td>
                                        <td>2023-12-17 10:15:30</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>ORD20231201008</td>
                                        <td>吴十</td>
                                        <td>132****3333</td>
                                        <td>数据结构与算法</td>
                                        <td>混合课程</td>
                                        <td>半年有效</td>
                                        <td>2024-06-01</td>
                                        <td>2023-12-03 11:45:20</td>
                                        <td><span class="status-badge status-frozen">已冻结</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>100学时</td>
                                        <td>¥2,800.00</td>
                                        <td>¥2,500.00</td>
                                        <td>2023-12-03 11:50:10</td>
                                        <td>2023-12-07 10:15:45</td>
                                        <td>余额支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>ORD20231201009</td>
                                        <td>郑十一</td>
                                        <td>131****4444</td>
                                        <td>Web开发实战</td>
                                        <td>在线课程</td>
                                        <td>永久有效</td>
                                        <td>-</td>
                                        <td>2023-12-04 14:20:15</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-invoice">已开票</span></td>
                                        <td>120学时</td>
                                        <td>¥3,200.00</td>
                                        <td>¥2,900.00</td>
                                        <td>2023-12-04 14:25:30</td>
                                        <td>2023-12-08 09:45:20</td>
                                        <td>微信支付</td>
                                        <td><span class="status-badge status-processing">结算中</span></td>
                                        <td>JS20231201004</td>
                                        <td>2023-12-18 16:45:20</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>ORD20231201010</td>
                                        <td>王十二</td>
                                        <td>130****5555</td>
                                        <td>数据库管理系统</td>
                                        <td>面授课程</td>
                                        <td>一年有效</td>
                                        <td>2024-12-01</td>
                                        <td>2023-12-05 16:10:25</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>90学时</td>
                                        <td>¥2,500.00</td>
                                        <td>¥2,200.00</td>
                                        <td>2023-12-05 16:15:40</td>
                                        <td>2023-12-09 11:30:15</td>
                                        <td>聚合支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="pagination">
                            <button class="page-btn">上一页</button>
                            <button class="page-btn active">1</button>
                            <button class="page-btn">2</button>
                            <button class="page-btn">3</button>
                            <button class="page-btn">下一页</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 导出记录模态框 -->
    <div class="modal" id="exportRecordsModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">导出记录</div>
                <button class="close-btn" onclick="hideExportRecordsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-records-container">
                    <table class="export-records-table">
                        <thead>
                            <tr>
                                <th>文件名称</th>
                                <th>导出状态</th>
                                <th>操作时间</th>
                                <th>操作人</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="exportRecordsTableBody">
                            <tr>
                                <td>退款订单_2023-12-01_2023-12-31.xlsx</td>
                                <td><span class="status-badge status-success">已完成</span></td>
                                <td>2023-12-15 14:30:25</td>
                                <td>张三</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="downloadFile('退款订单_2023-12-01_2023-12-31.xlsx')">下载</button>
                                </td>
                            </tr>
                            <tr>
                                <td>退款订单_2023-11-01_2023-11-30.xlsx</td>
                                <td><span class="status-badge status-success">已完成</span></td>
                                <td>2023-12-15 14:25:10</td>
                                <td>李四</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="downloadFile('退款订单_2023-11-01_2023-11-30.xlsx')">下载</button>
                                </td>
                            </tr>
                            <tr>
                                <td>退款订单_2023-10-01_2023-10-31.xlsx</td>
                                <td><span class="status-badge status-processing">执行中</span></td>
                                <td>2023-12-15 14:20:15</td>
                                <td>王五</td>
                                <td>
                                    <button class="btn btn-secondary btn-sm" disabled>等待中</button>
                                </td>
                            </tr>
                            <tr>
                                <td>退款订单_2023-09-01_2023-09-30.xlsx</td>
                                <td><span class="status-badge status-failed">执行失败</span></td>
                                <td>2023-12-15 14:15:30</td>
                                <td>赵六</td>
                                <td>
                                    <span style="color: #999; font-size: 12px;">-</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideExportRecordsModal()">关闭</button>
            </div>
        </div>
    </div>

    <style>
        /* 导出记录表格样式 */
        .export-records-container {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .export-records-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .export-records-table th,
        .export-records-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e8e8e8;
        }
        
        .export-records-table th {
            background-color: #fafafa;
            font-weight: 600;
            color: #262626;
        }
        
        .export-records-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
        }
        
        .status-badge.status-processing {
            background-color: #1890ff;
            color: white;
        }
        
        .status-badge.status-failed {
            background-color: #ff4d4f;
            color: white;
        }
        
        /* 成功提示样式 */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #52c41a;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>

    <!-- 公共脚本 -->
    <script src="scripts/components.js"></script>
    <script>
        // 页面特定的脚本
        document.addEventListener('DOMContentLoaded', function() {
            // 加载公共组件
            ComponentManager.loadComponent('sidebar', 'sidebar-container');
            ComponentManager.loadComponent('top-nav', 'top-nav-container');
            
            // 初始化页面
            ComponentManager.initializePage();
            
            // 绑定导出记录模态框事件
            bindExportRecordsModalEvents();
        });

        // 导出数据功能
        function exportData() {
            // 模拟异步导出
            showSuccessMessage('操作成功！任务生成后可点击查看导出记录，下载记录。');
            
            // 在实际应用中，这里会调用后端API
            // 例如：fetch('/api/export/refund-orders', { method: 'POST', body: JSON.stringify(exportParams) })
            console.log('开始异步导出退款订单数据...');
        }

        // 显示导出记录模态框
        function showExportRecordsModal() {
            document.getElementById('exportRecordsModal').classList.add('show');
        }

        // 隐藏导出记录模态框
        function hideExportRecordsModal() {
            document.getElementById('exportRecordsModal').classList.remove('show');
        }

        // 下载文件
        function downloadFile(fileName) {
            // 模拟文件下载
            console.log('下载文件:', fileName);
            
            // 在实际应用中，这里会创建一个下载链接
            // 例如：window.open('/api/download/' + fileName);
            
            showSuccessMessage('文件下载开始...');
        }



        // 显示成功提示消息
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.parentNode.removeChild(successDiv);
                }
            }, 3000);
        }

        // 绑定导出记录模态框事件
        function bindExportRecordsModalEvents() {
            // 点击导出记录模态框外部关闭
            const exportRecordsModal = document.getElementById('exportRecordsModal');
            if (exportRecordsModal) {
                exportRecordsModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        hideExportRecordsModal();
                    }
                });
            }
        }
    </script>
</body>
</html> 