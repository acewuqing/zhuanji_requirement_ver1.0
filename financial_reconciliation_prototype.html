<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>财务报表 - 交易账单对账</title>
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/sidebar.css">
</head>
<body>
    <!-- 左侧菜单导航栏 -->
    <div id="sidebar-container">
        <!-- 侧边栏组件将在这里加载 -->
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 顶部导航栏 -->
        <div id="top-nav-container">
            <!-- 顶部导航栏组件将在这里加载 -->
        </div>

        <!-- 页面内容 -->
        <div class="page-content">
            <!-- 面包屑导航 -->
            <div class="breadcrumb">
                <!-- 面包屑导航将在这里动态生成 -->
            </div>

            <!-- 内容容器 -->
            <div id="content-container">
                <div class="container">
                    <!-- 查询条件区域 -->
                    <div class="card">
                        <div class="card-title">查询条件</div>
                        <form class="form-grid">
                            <div class="form-group">
                                <label>订单号</label>
                                <input type="text" placeholder="请输入订单号">
                            </div>
                            <div class="form-group">
                                <label>专业</label>
                                <input type="text" placeholder="请输入专业名称">
                            </div>
                            <div class="form-group">
                                <label>科目</label>
                                <select>
                                    <option value="">请选择科目</option>
                                    <option value="1">计算机科学与技术</option>
                                    <option value="2">软件工程</option>
                                    <option value="3">数据科学</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>课程名称</label>
                                <input type="text" placeholder="请输入课程名称">
                            </div>
                            <div class="form-group">
                                <label>课程状态</label>
                                <select>
                                    <option value="">请选择状态</option>
                                    <option value="1">进行中</option>
                                    <option value="2">已完成</option>
                                    <option value="3">已取消</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>学员信息</label>
                                <input type="text" placeholder="姓名/手机号/身份证">
                            </div>
                            <div class="form-group">
                                <label>支付方式</label>
                                <select>
                                    <option value="">请选择支付方式</option>
                                    <option value="1">微信支付</option>
                                    <option value="2">聚合支付</option>
                                    <option value="3">余额支付</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>支付状态</label>
                                <select>
                                    <option value="">请选择支付状态</option>
                                    <option value="1">支付成功</option>
                                    <option value="2">支付失败</option>
                                    <option value="3">待支付</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>对账时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>课程类型</label>
                                <select>
                                    <option value="">请选择课程类型</option>
                                    <option value="1">在线课程</option>
                                    <option value="2">面授课程</option>
                                    <option value="3">混合课程</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>结算状态</label>
                                <select>
                                    <option value="">请选择结算状态</option>
                                    <option value="1">未结算</option>
                                    <option value="2">已结算</option>
                                    <option value="3">结算中</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>结算单号</label>
                                <input type="text" placeholder="请输入结算单号">
                            </div>
                            <div class="form-group">
                                <label>结算单生成时间</label>
                                <div class="date-range">
                                    <input type="date">
                                    <span>至</span>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="button" class="btn btn-primary">查询</button>
                                <button type="button" class="btn btn-secondary">重置</button>
                            </div>
                        </form>
                    </div>

                    <!-- 查询时间段未结算订单对账明细汇总区域 -->
                    <div class="card">
                        <div class="card-title">查询时间段未结算订单对账明细汇总</div>
                        <div class="reconciliation-summary-container">
                            <!-- 微信结算明细 -->
                            <div class="reconciliation-group wechat-group">
                                <div class="reconciliation-group-title wechat-title">微信结算明细</div>
                                <div class="reconciliation-grid">
                                    <div class="reconciliation-card wechat-section">
                                        <h4>
                                            微信支付合计（元）
                                            <span class="info-icon" title="所选时间段内，通过微信支付的开课订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过微信支付的开课订单金额</div>
                                        </h4>
                                        <div class="amount">¥110.00</div>
                                    </div>
                                    <div class="reconciliation-card wechat-section">
                                        <h4>
                                            微信退款合计（元）
                                            <span class="info-icon" title="所选时间段内，通过微信支付的退款订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过微信支付的退款订单金额</div>
                                        </h4>
                                        <div class="amount">¥110.00</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 聚合支付结算明细 -->
                            <div class="reconciliation-group aggregate-group">
                                <div class="reconciliation-group-title aggregate-title">聚合支付结算明细</div>
                                <div class="reconciliation-grid">
                                    <div class="reconciliation-card aggregate-section">
                                        <h4>
                                            聚合支付合计（元）
                                            <span class="info-icon" title="所选时间段内，通过聚合支付的开课订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过聚合支付的开课订单金额</div>
                                        </h4>
                                        <div class="amount">¥200.00</div>
                                    </div>
                                    <div class="reconciliation-card aggregate-section">
                                        <h4>
                                            聚合退款合计（元）
                                            <span class="info-icon" title="所选时间段内，通过聚合支付的退款订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过聚合支付的退款订单金额</div>
                                        </h4>
                                        <div class="amount">¥110.00</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 后台开课结算明细 -->
                            <div class="reconciliation-group backend-group">
                                <div class="reconciliation-group-title backend-title">后台开课结算明细</div>
                                <div class="reconciliation-grid">
                                    <div class="reconciliation-card backend-section">
                                        <h4>
                                            后台开课合计（元）
                                            <span class="info-icon" title="所选时间段内，通过后台开课的开课订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过后台开课的开课订单金额</div>
                                        </h4>
                                        <div class="amount">¥0.00</div>
                                    </div>
                                    <div class="reconciliation-card backend-section">
                                        <h4>
                                            后台退款合计（元）
                                            <span class="info-icon" title="所选时间段内，通过后台开课的退款订单金额"></span>
                                            <div class="tooltip">所选时间段内，通过后台开课的退款订单金额</div>
                                        </h4>
                                        <div class="amount">¥0.00</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 余额结算明细 -->
                            <div class="reconciliation-group balance-group">
                                <div class="reconciliation-group-title balance-title">余额结算明细</div>
                                <div class="reconciliation-grid">
                                    <div class="reconciliation-card balance-section">
                                        <h4>
                                            本期期初余额（元）
                                            <span class="info-icon" title="所选时间段内，开始时间这个节点的账户剩余余额，如果开始时间为空，则为0"></span>
                                            <div class="tooltip">所选时间段内，开始时间这个节点的账户剩余余额，如果开始时间为空，则为0</div>
                                        </h4>
                                        <div class="amount">¥100.00</div>
                                    </div>
                                    <div class="reconciliation-card balance-section">
                                        <h4>
                                            本期充值金额（元）
                                            <span class="info-icon" title="所选时间段内的总充值额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【充值】、状态为【正常】的所有数据的金额之和"></span>
                                            <div class="tooltip">所选时间段内的总充值额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【充值】、状态为【正常】的所有数据的金额之和</div>
                                        </h4>
                                        <div class="amount">¥50.00</div>
                                    </div>
                                    <div class="reconciliation-card balance-section">
                                        <h4>
                                            本期充值开课金额（元）
                                            <span class="info-icon" title="所选时间段内，用余额开通课程的总金额。统计所选时间段余额明细中流水类型为【支出】、交易类型为【消费】、状态为【正常】的所有数据的金额之和"></span>
                                            <div class="tooltip">所选时间段内，用余额开通课程的总金额。统计所选时间段余额明细中流水类型为【支出】、交易类型为【消费】、状态为【正常】的所有数据的金额之和</div>
                                        </h4>
                                        <div class="amount">¥40.00</div>
                                    </div>
                                    <div class="reconciliation-card balance-section">
                                        <h4>
                                            本期充值退款金额（元）
                                            <span class="info-icon" title="所选时间段内的充值退款金额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【退款】、状态为【正常】的所有数据的金额之和"></span>
                                            <div class="tooltip">所选时间段内的充值退款金额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【退款】、状态为【正常】的所有数据的金额之和</div>
                                        </h4>
                                        <div class="amount">¥10.00</div>
                                    </div>
                                    <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                        <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                            本期账户余额退款（元）
                                            <span class="info-icon" title="所选时间段内的总账户余额退款。统计所选时间段余额明细中流水类型为【支出】、交易类型为【作废】、状态为【正常】的所有数据的金额之和"></span>
                                            <div class="tooltip">所选时间段内的总账户余额退款。统计所选时间段余额明细中流水类型为【支出】、交易类型为【作废】、状态为【正常】的所有数据的金额之和</div>
                                        </h4>
                                        <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥0.00</div>
                                    </div>
                                    <div class="reconciliation-card balance-section">
                                        <h4>
                                            本期账户余额（元）
                                            <span class="info-icon" title="如果筛选时间，开始时间和结束时间都为空，则本期账户余额=系统截止到当前时间的账户余额；否则，本期账户余额=本期期初余额+本期充值金额-本期充值开课金额+本期充值退款-本期账户余额退款"></span>
                                            <div class="tooltip">如果筛选时间，开始时间和结束时间都为空，则本期账户余额=系统截止到当前时间的账户余额；否则，本期账户余额=本期期初余额+本期充值金额-本期充值开课金额+本期充值退款-本期账户余额退款</div>
                                        </h4>
                                        <div class="amount">¥120.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 操作按钮区域 -->
                    <div class="action-section">
                        <div class="action-left">
                            <button class="btn btn-success" onclick="showConfirmModal()">生成结算单</button>
                            <button class="btn btn-warning" onclick="exportData()">导出数据</button>
                            <button class="btn btn-info" onclick="showExportRecordsModal()">查看导出记录</button>
                        </div>
                        <div>
                            <span style="color: #666; font-size: 14px;">
                                支付订单：<strong style="color: #52c41a;">1,180</strong> 条 | 
                                退款订单：<strong style="color: #fa8c16;">76</strong> 条
                            </span>
                        </div>
                    </div>

                    <!-- 表格区域 -->
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">交易账单列表</div>
                            <div class="table-tabs">
                                <button class="tab active">交易账单</button>
                                <button class="tab">退款单</button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>订单号</th>
                                        <th>学员名称</th>
                                        <th>手机号</th>
                                        <th>课程名称</th>
                                        <th>课程类型</th>
                                        <th>有效类型</th>
                                        <th>有效结束时间</th>
                                        <th>订单时间</th>
                                        <th>冻结状态</th>
                                        <th>支付状态</th>
                                        <th>发票状态</th>
                                        <th>课程学时</th>
                                        <th>订单金额</th>
                                        <th>实付金额</th>
                                        <th>支付时间</th>
                                        <th>退款时间</th>
                                        <th>支付方式</th>
                                        <th>结算状态</th>
                                        <th>结算单号</th>
                                        <th>结算单生成时间</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>ORD20231201001</td>
                                        <td>张三</td>
                                        <td>138****1234</td>
                                        <td>Java高级开发</td>
                                        <td>在线课程</td>
                                        <td>永久有效</td>
                                        <td>-</td>
                                        <td>2023-12-01 14:25:10</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-invoice">已开票</span></td>
                                        <td>120学时</td>
                                        <td>¥3,000.00</td>
                                        <td>¥2,800.00</td>
                                        <td>2023-12-01 14:30:25</td>
                                        <td>-</td>
                                        <td>微信支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>ORD20231201002</td>
                                        <td>李四</td>
                                        <td>139****5678</td>
                                        <td>Python数据分析</td>
                                        <td>面授课程</td>
                                        <td>一年有效</td>
                                        <td>2024-12-01</td>
                                        <td>2023-12-01 15:15:30</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>80学时</td>
                                        <td>¥1,800.00</td>
                                        <td>¥1,500.00</td>
                                        <td>2023-12-01 15:20:18</td>
                                        <td>-</td>
                                        <td>聚合支付</td>
                                        <td><span class="status-badge status-success">已结算</span></td>
                                        <td>JS20231201001</td>
                                        <td>2023-12-15 09:30:25</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>ORD20231201003</td>
                                        <td>王五</td>
                                        <td>137****9012</td>
                                        <td>机器学习基础</td>
                                        <td>混合课程</td>
                                        <td>半年有效</td>
                                        <td>2024-06-01</td>
                                        <td>2023-12-01 16:05:42</td>
                                        <td><span class="status-badge status-frozen">已冻结</span></td>
                                        <td><span class="status-badge status-pending">待支付</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>100学时</td>
                                        <td>¥3,500.00</td>
                                        <td>¥3,200.00</td>
                                        <td>-</td>
                                        <td>-</td>
                                        <td>余额支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>ORD20231201004</td>
                                        <td>赵六</td>
                                        <td>136****3456</td>
                                        <td>Web前端开发</td>
                                        <td>在线课程</td>
                                        <td>永久有效</td>
                                        <td>-</td>
                                        <td>2023-12-01 17:05:20</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-failed">支付失败</span></td>
                                        <td><span class="status-badge status-pending">待开票</span></td>
                                        <td>90学时</td>
                                        <td>¥2,000.00</td>
                                        <td>¥1,800.00</td>
                                        <td>2023-12-01 17:10:15</td>
                                        <td>-</td>
                                        <td>微信支付</td>
                                        <td><span class="status-badge status-pending">未结算</span></td>
                                        <td>-</td>
                                        <td>-</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>ORD20231201005</td>
                                        <td>钱七</td>
                                        <td>135****7890</td>
                                        <td>数据库设计</td>
                                        <td>面授课程</td>
                                        <td>一年有效</td>
                                        <td>2024-12-01</td>
                                        <td>2023-12-01 18:25:15</td>
                                        <td><span class="status-badge status-success">正常</span></td>
                                        <td><span class="status-badge status-success">支付成功</span></td>
                                        <td><span class="status-badge status-invoice">已开票</span></td>
                                        <td>60学时</td>
                                        <td>¥2,500.00</td>
                                        <td>¥2,100.00</td>
                                        <td>2023-12-01 18:30:45</td>
                                        <td>-</td>
                                        <td>聚合支付</td>
                                        <td><span class="status-badge status-processing">结算中</span></td>
                                        <td>JS20231201002</td>
                                        <td>2023-12-16 14:20:15</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="pagination">
                            <button class="page-btn">上一页</button>
                            <button class="page-btn active">1</button>
                            <button class="page-btn">2</button>
                            <button class="page-btn">3</button>
                            <button class="page-btn">下一页</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认模态框 -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">确认生成结算单</div>
                <button class="close-btn" onclick="hideConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- 对账时间+订单条数一行展示（样式统一） -->
                <div class="time-order-row" style="display: flex; align-items: flex-start; gap: 32px; margin-bottom: 16px;">
                    <!-- 对账时间区块（卡片样式） -->
                    <div class="info-card" style="flex: 1; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 16px 20px; min-width: 260px; box-sizing: border-box;">
                        <div class="info-card-title" style="font-size: 16px; font-weight: bold; color: #1890ff; margin-bottom: 8px;">结算时间段</div>
                        <div class="info-card-content" style="display: flex; flex-direction: column; gap: 8px;">
                            <div class="info-card-row" style="display: flex; align-items: center; gap: 8px;">
                                <span class="info-card-label" style="color: #6c757d; font-size: 14px;">开始时间：</span>
                                <span class="info-card-value" style="color: #495057; font-weight: bold;">2023-12-01 00:00:00</span>
                            </div>
                            <div class="info-card-row" style="display: flex; align-items: center; gap: 8px;">
                                <span class="info-card-label" style="color: #6c757d; font-size: 14px;">结束时间：</span>
                                <span class="info-card-value" style="color: #495057; font-weight: bold;">2023-12-31 23:59:59</span>
                            </div>
                        </div>
                    </div>
                    <!-- 订单条数信息区块（卡片样式） -->
                    <div class="info-card" style="flex: 1; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 16px 20px; min-width: 260px; box-sizing: border-box;">
                        <div class="info-card-title" style="font-size: 16px; font-weight: bold; color: #1890ff; margin-bottom: 8px;">订单条数</div>
                        <div class="info-card-content" style="display: flex; flex-direction: column; gap: 8px;">
                            <div class="info-card-row" style="display: flex; justify-content: space-between; align-items: center;">
                                <span class="info-card-label" style="color: #6c757d; font-size: 14px;">支付订单条数：</span>
                                <span class="info-card-value" style="color: #495057; font-weight: bold;">1,180 笔</span>
                            </div>
                            <div class="info-card-row" style="display: flex; justify-content: space-between; align-items: center;">
                                <span class="info-card-label" style="color: #6c757d; font-size: 14px;">退款订单条数：</span>
                                <span class="info-card-value" style="color: #495057; font-weight: bold;">76 笔</span>
                            </div>
                            <div class="info-card-row" style="display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #dee2e6; padding-top: 8px;">
                                <span class="info-card-label" style="color: #495057; font-weight: bold;">总订单条数：</span>
                                <span class="info-card-value" style="color: #1890ff; font-weight: bold; font-size: 16px;">1,256 笔</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 结算时间段未结算订单对账明细汇总 -->
                <div class="confirm-reconciliation-section" style="margin-top: 24px; border-top: 2px solid #f0f0f0; padding-top: 20px;">
                    <div class="confirm-summary-group-title" style="color: #262626; font-weight: bold; font-size: 16px; margin-bottom: 16px;">结算时间段未结算订单对账明细汇总</div>
                    <div class="confirm-reconciliation-container" style="display: flex; flex-direction: row; gap: 12px; flex-wrap: wrap;">
                        <!-- 微信结算明细 -->
                        <div class="confirm-reconciliation-group wechat-group" style="flex: 1; min-width: 240px;">
                            <div class="confirm-reconciliation-group-title wechat-title" style="font-size: 14px; font-weight: 600; color: #07c160; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid #e8f5e8;">微信结算明细</div>
                            <div class="confirm-reconciliation-grid" style="display: flex; flex-direction: column; gap: 8px;">
                                <div class="confirm-reconciliation-card wechat-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #07c160;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        微信支付合计（元）
                                        <span class="info-icon" title="所选时间段内，通过微信支付的开课订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过微信支付的开课订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥110.00</div>
                                </div>
                                <div class="confirm-reconciliation-card wechat-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #07c160;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        微信退款合计（元）
                                        <span class="info-icon" title="所选时间段内，通过微信支付的退款订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过微信支付的退款订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥110.00</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 聚合支付结算明细 -->
                        <div class="confirm-reconciliation-group aggregate-group" style="flex: 1; min-width: 240px;">
                            <div class="confirm-reconciliation-group-title aggregate-title" style="font-size: 14px; font-weight: 600; color: #1890ff; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid #e8f4fd;">聚合支付结算明细</div>
                            <div class="confirm-reconciliation-grid" style="display: flex; flex-direction: column; gap: 8px;">
                                <div class="confirm-reconciliation-card aggregate-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #1890ff;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        聚合支付合计（元）
                                        <span class="info-icon" title="所选时间段内，通过聚合支付的开课订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过聚合支付的开课订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥200.00</div>
                                </div>
                                <div class="confirm-reconciliation-card aggregate-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #1890ff;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        聚合退款合计（元）
                                        <span class="info-icon" title="所选时间段内，通过聚合支付的退款订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过聚合支付的退款订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥110.00</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 后台开课结算明细 -->
                        <div class="confirm-reconciliation-group backend-group" style="flex: 1; min-width: 240px;">
                            <div class="confirm-reconciliation-group-title backend-title" style="font-size: 14px; font-weight: 600; color: #722ed1; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid #f3e8ff;">后台开课结算明细</div>
                            <div class="confirm-reconciliation-grid" style="display: flex; flex-direction: column; gap: 8px;">
                                <div class="confirm-reconciliation-card backend-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #722ed1;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        后台开课合计（元）
                                        <span class="info-icon" title="所选时间段内，通过后台开课的开课订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过后台开课的开课订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥0.00</div>
                                </div>
                                <div class="confirm-reconciliation-card backend-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #722ed1;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        后台退款合计（元）
                                        <span class="info-icon" title="所选时间段内，通过后台开课的退款订单金额"></span>
                                        <div class="tooltip">所选时间段内，通过后台开课的退款订单金额</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥0.00</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 余额结算明细 -->
                        <div class="confirm-reconciliation-group balance-group" style="flex: 1; min-width: 240px;">
                            <div class="confirm-reconciliation-group-title balance-title" style="font-size: 14px; font-weight: 600; color: #fa8c16; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid #fff7e6;">余额结算明细</div>
                            <div class="confirm-reconciliation-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期期初余额（元）
                                        <span class="info-icon" title="所选时间段内，开始时间这个节点的账户剩余余额，如果开始时间为空，则为0"></span>
                                        <div class="tooltip">所选时间段内，开始时间这个节点的账户剩余余额，如果开始时间为空，则为0</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥100.00</div>
                                </div>
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期充值金额（元）
                                        <span class="info-icon" title="所选时间段内的总充值额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【充值】、状态为【正常】的所有数据的金额之和"></span>
                                        <div class="tooltip">所选时间段内的总充值额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【充值】、状态为【正常】的所有数据的金额之和</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥50.00</div>
                                </div>
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期充值开课金额（元）
                                        <span class="info-icon" title="所选时间段内，用余额开通课程的总金额。统计所选时间段余额明细中流水类型为【支出】、交易类型为【消费】、状态为【正常】的所有数据的金额之和"></span>
                                        <div class="tooltip">所选时间段内，用余额开通课程的总金额。统计所选时间段余额明细中流水类型为【支出】、交易类型为【消费】、状态为【正常】的所有数据的金额之和</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥40.00</div>
                                </div>
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期充值退款金额（元）
                                        <span class="info-icon" title="所选时间段内的充值退款金额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【退款】、状态为【正常】的所有数据的金额之和"></span>
                                        <div class="tooltip">所选时间段内的充值退款金额。统计所选时间段余额明细中流水类型为【收入】、交易类型为【退款】、状态为【正常】的所有数据的金额之和</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥10.00</div>
                                </div>
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期账户余额退款（元）
                                        <span class="info-icon" title="所选时间段内的总账户余额退款。统计所选时间段余额明细中流水类型为【支出】、交易类型为【作废】、状态为【正常】的所有数据的金额之和"></span>
                                        <div class="tooltip">所选时间段内的总账户余额退款。统计所选时间段余额明细中流水类型为【支出】、交易类型为【作废】、状态为【正常】的所有数据的金额之和</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥0.00</div>
                                </div>
                                <div class="confirm-reconciliation-card balance-section" style="background: #fafafa; border: 1px solid #e8e8e8; border-radius: 4px; padding: 8px; border-left: 4px solid #fa8c16;">
                                    <h4 style="margin: 0 0 4px 0; font-size: 12px; color: #595959; font-weight: 500; display: flex; align-items: center; gap: 4px;">
                                        本期账户余额（元）
                                        <span class="info-icon" title="如果筛选时间，开始时间和结束时间都为空，则本期账户余额=系统截止到当前时间的账户余额；否则，本期账户余额=本期期初余额+本期充值金额-本期充值开课金额+本期充值退款-本期账户余额退款"></span>
                                        <div class="tooltip">如果筛选时间，开始时间和结束时间都为空，则本期账户余额=系统截止到当前时间的账户余额；否则，本期账户余额=本期期初余额+本期充值金额-本期充值开课金额+本期充值退款-本期账户余额退款</div>
                                    </h4>
                                    <div class="amount" style="font-size: 14px; font-weight: 600; color: #262626;">¥120.00</div>
                                </div>
                              
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideConfirmModal()">取消</button>
                <button class="btn btn-success" onclick="generateSettlement()">确认生成</button>
            </div>
        </div>
    </div>

    <!-- 导出记录模态框 -->
    <div class="modal" id="exportRecordsModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">导出记录</div>
                <button class="close-btn" onclick="hideExportRecordsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-records-container">
                    <table class="export-records-table">
                        <thead>
                            <tr>
                                <th>文件名称</th>
                                <th>导出状态</th>
                                <th>操作时间</th>
                                <th>操作人</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="exportRecordsTableBody">
                            <tr>
                                <td>交易账单_2023-12-01_2023-12-31.xlsx</td>
                                <td><span class="status-badge status-success">已完成</span></td>
                                <td>2023-12-15 14:30:25</td>
                                <td>张三</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="downloadFile('交易账单_2023-12-01_2023-12-31.xlsx')">下载</button>
                                </td>
                            </tr>
                            <tr>
                                <td>退款单_2023-12-01_2023-12-31.xlsx</td>
                                <td><span class="status-badge status-success">已完成</span></td>
                                <td>2023-12-15 14:25:10</td>
                                <td>张三</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="downloadFile('退款单_2023-12-01_2023-12-31.xlsx')">下载</button>
                                </td>
                            </tr>
                            <tr>
                                <td>交易账单_2023-11-01_2023-11-30.xlsx</td>
                                <td><span class="status-badge status-processing">执行中</span></td>
                                <td>2023-12-15 14:20:15</td>
                                <td>李四</td>
                                <td>
                                    <button class="btn btn-secondary btn-sm" disabled>等待中</button>
                                </td>
                            </tr>
                            <tr>
                                <td>交易账单_2023-10-01_2023-10-31.xlsx</td>
                                <td><span class="status-badge status-failed">执行失败</span></td>
                                <td>2023-12-15 14:15:30</td>
                                <td>王五</td>
                                <td>
                                    <span style="color: #999; font-size: 12px;">-</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideExportRecordsModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 产品需求说明展示区域 -->
    <div class="card" style="margin-top: 24px;">
        <div class="card-content">
            <div style="padding: 20px; text-align: left;margin-left: 500px; color: #666; font-size: 16px;">
                需求说明补充<br/>
                查询条件及列表：<br/>
                1、列表查询条件，默认展示未结算的数据<br/>
                2、对账时间说明：订单对账明细汇总和交易账单根据订单支付时间匹配查询统计，退款汇总和退款单根据退款时间匹配查询统计<br/>

                功能按钮：<br/>
                3、点击“生成结算单”按钮，后台校验查询的订单和退款单是否都是未结算的，否则提示“请查询订单状态为“未结算”的订单进行结算！”
            </div>
        </div>
    </div>

    <style>
        /* 导出记录表格样式 */
        .export-records-container {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .export-records-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .export-records-table th,
        .export-records-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e8e8e8;
        }
        
        .export-records-table th {
            background-color: #fafafa;
            font-weight: 600;
            color: #262626;
        }
        
        .export-records-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
        }
        
        .status-badge.status-processing {
            background-color: #1890ff;
            color: white;
        }
        
        .status-badge.status-failed {
            background-color: #ff4d4f;
            color: white;
        }
        

        
        /* 对账明细汇总样式 */
        .reconciliation-summary-container {
            display: flex;
            flex-direction: row;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .reconciliation-group {
            background: #fff;
            border: 1px solid #e8e8e8;
            border-radius: 6px;
            padding: 12px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
            flex: 1;
            min-width: 240px;
        }
        
        .reconciliation-group-title {
            font-size: 14px;
            font-weight: 600;
            color: #262626;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
        }
        
        .wechat-title {
            color: #07c160;
            border-bottom-color: #e8f5e8;
        }
        
        .aggregate-title {
            color: #1890ff;
            border-bottom-color: #e8f4fd;
        }
        
        .backend-title {
            color: #722ed1;
            border-bottom-color: #f3e8ff;
        }
        
        .balance-title {
            color: #fa8c16;
            border-bottom-color: #fff7e6;
        }
        

        

        
        .reconciliation-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .balance-group .reconciliation-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        

        
        .reconciliation-card {
            background: #fafafa;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            padding: 8px;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .reconciliation-card:hover {
            background: #f5f5f5;
            border-color: #d9d9d9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .reconciliation-card h4 {
            margin: 0 0 4px 0;
            font-size: 12px;
            color: #595959;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .reconciliation-card .amount {
            font-size: 14px;
            font-weight: 600;
            color: #262626;
        }
        
        .wechat-section {
            border-left: 4px solid #07c160;
        }
        
        .aggregate-section {
            border-left: 4px solid #1890ff;
        }
        
        .backend-section {
            border-left: 4px solid #722ed1;
        }
        
        .balance-section {
            border-left: 4px solid #fa8c16;
        }
        

        

        
        /* 成功提示样式 */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #52c41a;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>

    <!-- 公共脚本 -->
    <script src="scripts/components.js"></script>
    <script>
        // 页面特定的脚本
        document.addEventListener('DOMContentLoaded', function() {
            // 加载公共组件
            ComponentManager.loadComponent('sidebar', 'sidebar-container');
            ComponentManager.loadComponent('top-nav', 'top-nav-container');
            
            // 初始化页面
            ComponentManager.initializePage();
            
            // 初始化工具提示
            initializeTooltips();
            

            
            // 绑定事件
            bindEvents();
        });

        // 显示确认模态框
        function showConfirmModal() {
            document.getElementById('confirmModal').classList.add('show');
        }

        // 隐藏确认模态框
        function hideConfirmModal() {
            document.getElementById('confirmModal').classList.remove('show');
        }

        // 生成结算单
        function generateSettlement() {
            alert('结算单生成成功！');
            hideConfirmModal();
        }

        // 标签页切换
        function bindEvents() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // 点击模态框外部关闭
            document.getElementById('confirmModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideConfirmModal();
                }
            });
        }

        // 初始化工具提示
        function initializeTooltips() {
            const infoIcons = document.querySelectorAll('.info-icon');
            infoIcons.forEach(icon => {
                // 为分组标题中的悬浮提示添加特殊处理
                const isGroupTitleIcon = icon.closest('.confirm-summary-group-title');
                const isReconciliationGroupTitleIcon = icon.closest('.reconciliation-group-title');
                
                if (!isGroupTitleIcon && !isReconciliationGroupTitleIcon) {
                    // 其他悬浮提示使用JavaScript事件
                    icon.addEventListener('mouseenter', function() {
                        const tooltip = this.nextElementSibling;
                        if (tooltip && tooltip.classList.contains('tooltip')) {
                            tooltip.style.display = 'block';
                        }
                    });
                    
                    icon.addEventListener('mouseleave', function() {
                        const tooltip = this.nextElementSibling;
                        if (tooltip && tooltip.classList.contains('tooltip')) {
                            tooltip.style.display = 'none';
                        }
                    });
                }
            });
        }

        // 导出数据功能
        function exportData() {
            // 模拟异步导出
            showSuccessMessage('操作成功！任务生成后可点击查看导出记录，下载记录。');
            
            // 在实际应用中，这里会调用后端API
            // 例如：fetch('/api/export', { method: 'POST', body: JSON.stringify(exportParams) })
            console.log('开始异步导出数据...');
        }

        // 显示导出记录模态框
        function showExportRecordsModal() {
            document.getElementById('exportRecordsModal').classList.add('show');
        }

        // 隐藏导出记录模态框
        function hideExportRecordsModal() {
            document.getElementById('exportRecordsModal').classList.remove('show');
        }

        // 下载文件
        function downloadFile(fileName) {
            // 模拟文件下载
            console.log('下载文件:', fileName);
            
            // 在实际应用中，这里会创建一个下载链接
            // 例如：window.open('/api/download/' + fileName);
            
            showSuccessMessage('文件下载开始...');
        }



        // 显示成功提示消息
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.parentNode.removeChild(successDiv);
                }
            }, 3000);
        }

        // 绑定导出记录模态框事件
        document.addEventListener('DOMContentLoaded', function() {
            // 点击导出记录模态框外部关闭
            const exportRecordsModal = document.getElementById('exportRecordsModal');
            if (exportRecordsModal) {
                exportRecordsModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        hideExportRecordsModal();
                    }
                });
            }
        });


    </script>


</body>


</html> 