<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的订单</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f8f8f8;
            font-family: 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;
        }
        .top-bar {
            background: #1686ff;
            color: #fff;
            padding: 0;
            position: relative;
            height: 170px; /* 增加高度，避免tab重叠 */
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }
        .status-bar {
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 16px;
            font-size: 14px;
        }
        .back-btn {
            position: absolute;
            left: 16px;
            top: 56px;
            width: 28px;
            height: 28px;
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
        }
        .title {
            text-align: center;
            font-size: 22px;
            font-weight: 500;
            margin-top: 56px;
            letter-spacing: 1px;
        }
        .order-icon {
            position: absolute;
            right: 24px;
            top: 48px;
            width: 56px;
            height: 56px;
        }
        .tab-bar {
            background: #fff;
            display: flex;
            border-radius: 16px 16px 0 0;
            margin-top: -12px; /* 让tab栏紧贴蓝色区域底部 */
            box-shadow: 0 2px 8px rgba(22,134,255,0.08);
            overflow: hidden;
        }
        .tab-item {
            flex: 1;
            text-align: center;
            padding: 14px 0 12px 0;
            font-size: 16px;
            color: #222;
            cursor: pointer;
            position: relative;
        }
        .tab-item.active {
            color: #1686ff;
            font-weight: 600;
        }
        .tab-item.active::after {
            content: '';
            display: block;
            width: 32px;
            height: 3px;
            background: #1686ff;
            border-radius: 2px;
            margin: 8px auto 0 auto;
        }
        .order-list {
            margin: 0;
            padding: 0 0 24px 0;
        }
        .order-card {
            background: #fff;
            border-radius: 14px;
            margin: 18px 16px 0 16px;
            box-shadow: 0 2px 8px rgba(22,134,255,0.04);
            padding: 18px 16px 12px 16px;
        }
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 15px;
            color: #222;
        }
        .order-time {
            color: #222;
            font-size: 15px;
        }
        .order-status {
            color: #1686ff;
            font-size: 15px;
        }
        .order-body {
            display: flex;
            margin-top: 12px;
        }
        .course-img {
            width: 56px;
            height: 56px;
            border-radius: 8px;
            object-fit: cover;
            margin-right: 12px;
            background: #eee;
        }
        .course-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .course-title {
            font-size: 16px;
            color: #222;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        .order-amount {
            color: #ff3b30;
            font-size: 15px;
            font-weight: 500;
            margin-top: 2px;
        }
        .order-actions {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-top: 16px;
            gap: 12px;
        }
        .order-btn {
            background: #f5f5f5;
            color: #bbb;
            border: none;
            border-radius: 16px;
            padding: 6px 18px;
            font-size: 15px;
            cursor: pointer;
        }
        .order-btn.primary {
            background: #1686ff;
            color: #fff;
            cursor: pointer;
        }
        /* 退课申请弹窗样式 */
        .modal-mask {
            position: fixed;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.25);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .modal {
            background: #fff;
            border-radius: 12px;
            width: 88vw;
            max-width: 380px;
            box-shadow: 0 8px 32px rgba(22,134,255,0.12);
            padding: 24px 20px 18px 20px;
            display: flex;
            flex-direction: column;
        }
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #222;
            margin-bottom: 16px;
            text-align: center;
        }
        .modal textarea {
            width: 100%;
            min-height: 64px;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            font-size: 15px;
            padding: 8px;
            resize: none;
            margin-bottom: 10px;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 8px;
        }
        .modal-btn {
            border: none;
            border-radius: 16px;
            padding: 6px 20px;
            font-size: 15px;
            cursor: pointer;
        }
        .modal-btn.cancel {
            background: #f5f5f5;
            color: #888;
        }
        .modal-btn.submit {
            background: #1686ff;
            color: #fff;
        }
        .modal-error {
            color: #ff3b30;
            font-size: 13px;
            margin-bottom: 6px;
            text-align: left;
            min-height: 18px;
        }
        .textarea-wrapper {
            position: relative;
            width: 100%;
        }
        .textarea-wrapper textarea {
            width: 100%;
            box-sizing: border-box;
            padding-bottom: 28px;
            padding-right: 60px;
            resize: none;
        }
        .modal-char-count {
            position: absolute;
            right: 16px;
            bottom: 22px;
            color: #888;
            font-size: 13px;
            background: #fff;
            line-height: 1;
            pointer-events: none;
            z-index: 2;
            padding: 0 2px;
        }
        @media (max-width: 500px) {
            .order-card { margin: 14px 4px 0 4px; }
            .modal-char-count {
                right: 10px;
                bottom: 18px;
                font-size: 12px;
            }
            .textarea-wrapper textarea {
                padding-right: 44px;
                padding-bottom: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="status-bar">
            <!-- 状态栏占位，可根据需要自定义 -->
            <span style="margin-left:auto;">24</span>
            <span style="margin-left:8px;">🔋</span>
        </div>
        <button class="back-btn">&#8592;</button>
        <div class="title">我的订单</div>
        <img class="order-icon" src="data:image/svg+xml;utf8,<svg width='56' height='56' viewBox='0 0 56 56' fill='none' xmlns='http://www.w3.org/2000/svg'><rect x='8' y='12' width='40' height='32' rx='4' fill='%23fff'/><rect x='16' y='20' width='24' height='4' rx='2' fill='%231686ff'/><rect x='16' y='28' width='16' height='4' rx='2' fill='%231686ff'/><rect x='16' y='36' width='12' height='4' rx='2' fill='%231686ff'/><circle cx='44' cy='44' r='6' fill='%23fff'/><path d='M44 40v4l2 2' stroke='%231686ff' stroke-width='2' stroke-linecap='round'/></svg>" alt="订单图标" />
    </div>
    <div class="tab-bar">
        <div class="tab-item active">全部</div>
        <div class="tab-item">待付款</div>
        <div class="tab-item">已完成</div>
        <div class="tab-item">退款/售后</div>
    </div>
    <div class="order-list">
        <div class="order-card">
            <div class="order-header">
                <span class="order-time">2025-07-11 14:57:54</span>
                <span class="order-status">已完成</span>
            </div>
            <div class="order-body">
                <img class="course-img" src="https://img1.imgtp.com/2023/07/21/8QwQwQwQ.png" alt="课程图片" />
                <div class="course-info">
                    <div class="course-title">施工成本计划编制核心知识点与案例</div>
                    <div class="order-amount">总金额 ￥5</div>
                </div>
            </div>
            <div class="order-actions">
                <button class="order-btn refund-btn">申请退课</button>
                <button class="order-btn">评价</button>
                <button class="order-btn primary">查看详情</button>
            </div>
        </div>
        <div class="order-card">
            <div class="order-header">
                <span class="order-time">2025-07-11 10:50:39</span>
                <span class="order-status">已完成</span>
            </div>
            <div class="order-body">
                <img class="course-img" src="https://img1.imgtp.com/2023/07/21/8QwQwQwQ.png" alt="课程图片" />
                <div class="course-info">
                    <div class="course-title">二级建造师继续教育（水利水电工程）培训课程（二）</div>
                    <div class="order-amount">总金额 ￥150</div>
                </div>
            </div>
            <div class="order-actions">
                <button class="order-btn refund-btn">申请退课</button>
                <button class="order-btn">评价</button>
                <button class="order-btn primary">查看详情</button>
            </div>
        </div>
        <div class="order-card">
            <div class="order-header">
                <span class="order-time">2025-07-11 10:50:39</span>
                <span class="order-status">已完成</span>
            </div>
            <div class="order-body">
                <img class="course-img" src="https://img1.imgtp.com/2023/07/21/8QwQwQwQ.png" alt="课程图片" />
                <div class="course-info">
                    <div class="course-title">二级建造师继续教育（水利水电工程）培训课程（一）</div>
                    <div class="order-amount">总金额 ￥150</div>
                </div>
            </div>
            <div class="order-actions">
                <button class="order-btn refund-btn">申请退课</button>
                <button class="order-btn">评价</button>
                <button class="order-btn primary">查看详情</button>
            </div>
        </div>
    </div>
    <!-- 退课申请弹窗 -->
    <div class="modal-mask" id="refundModalMask">
        <div class="modal">
            <div class="modal-title">申请退课</div>
            <div class="modal-error" id="refundError"></div>
            <div class="textarea-wrapper">
                <textarea id="refundReason" placeholder="请填写退课原因（必填）" maxlength="200"></textarea>
                <span class="modal-char-count" id="refundCharCount">1/200</span>
            </div>
            <div class="modal-actions">
                <button class="modal-btn cancel" id="refundCancelBtn">取消</button>
                <button class="modal-btn submit" id="refundSubmitBtn">提交</button>
            </div>
        </div>
    </div>
    <script>
    // 退课弹窗逻辑
    const refundBtns = document.querySelectorAll('.refund-btn');
    const refundModal = document.getElementById('refundModalMask');
    const refundCancelBtn = document.getElementById('refundCancelBtn');
    const refundSubmitBtn = document.getElementById('refundSubmitBtn');
    const refundReason = document.getElementById('refundReason');
    const refundError = document.getElementById('refundError');
    const refundCharCount = document.getElementById('refundCharCount');
    refundBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            refundModal.style.display = 'flex';
            refundReason.value = '';
            refundError.textContent = '';
            refundCharCount.textContent = '1/200';
        });
    });
    refundCancelBtn.onclick = function() {
        refundModal.style.display = 'none';
    };
    refundSubmitBtn.onclick = function() {
        if (!refundReason.value.trim()) {
            refundError.textContent = '退课原因不能为空';
            refundReason.focus();
            return;
        }
        refundError.textContent = '';
        refundModal.style.display = 'none';
        alert('退课申请已提交：' + refundReason.value.trim());
    };
    // 点击遮罩关闭弹窗（可选）
    refundModal.addEventListener('click', function(e) {
        if (e.target === refundModal) refundModal.style.display = 'none';
    });

    // 退课原因字数统计和限制
    refundReason.addEventListener('input', function() {
        let val = refundReason.value;
        if (val.length > 200) {
            refundReason.value = val.slice(0, 200);
            val = refundReason.value;
        }
        refundCharCount.textContent = (val.length === 0 ? 1 : val.length) + '/200';
    });

    // 订单卡片和查看详情按钮跳转逻辑
    // 保证所有“查看详情”按钮都能跳转到 order_detail.html
    // 并阻止事件冒泡

    document.querySelectorAll('.order-btn.primary, .view-detail-btn').forEach(function(btn) {
      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        window.location.href = 'order_detail.html';
      });
    });
    </script>
</body>
</html> 