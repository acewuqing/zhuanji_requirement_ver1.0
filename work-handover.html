<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥ä½œäº¤æ¥ - èµ„æ–™ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Header styles */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background-color: #fff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 18px;
            font-weight: 500;
            color: #333;
        }
        
        .logo-icon {
            color: #1677ff;
            margin-right: 8px;
            font-size: 24px;
        }
        
        .header-right {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .header-icon {
            font-size: 20px;
            color: #666;
            cursor: pointer;
        }
        
        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            background-color: #ccc;
        }
        
        /* Sidebar styles */
        .sidebar {
            width: 210px;
            background-color: #fff;
            border-right: 1px solid #e8e8e8;
            padding-top: 56px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .menu {
            padding: 8px 0;
        }
        
        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            color: #666;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .menu-item:hover {
            background-color: #f5f5f5;
        }
        
        .menu-item.active {
            background-color: #f0f7ff;
            color: #1677ff;
            border-right: 3px solid #1677ff;
        }
        
        .menu-icon {
            margin-right: 12px;
            font-size: 18px;
        }
        
        .menu-arrow {
            margin-left: auto;
            font-size: 12px;
        }
        
        /* Main content styles */
        .main-content {
            flex: 1;
            margin-left: 210px;
            padding-top: 56px;
            padding-bottom: 20px;
        }
        
        .page-header {
            padding: 16px 20px;
            background-color: #fff;
            border-bottom: 1px solid #e8e8e8;
        }
        
        .page-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .breadcrumb {
            font-size: 14px;
            color: #999;
        }
        
        .breadcrumb a {
            color: #1677ff;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .content-wrapper {
            padding: 20px;
        }
        
        .filter-bar {
            background-color: #fff;
            padding: 16px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }
        
        .search-input {
            display: flex;
            align-items: center;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            padding: 0 12px;
            height: 36px;
            width: 240px;
        }
        
        .search-input input {
            border: none;
            outline: none;
            flex: 1;
            height: 100%;
            font-size: 14px;
        }
        
        .search-icon {
            color: #999;
            cursor: pointer;
        }
        
        .select-wrapper {
            position: relative;
            height: 36px;
            min-width: 150px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            cursor: pointer;
            color: #666;
        }
        
        .select-text {
            flex: 1;
            font-size: 14px;
        }
        
        .select-arrow {
            color: #999;
        }
        
        .filter-actions {
            margin-left: auto;
            display: flex;
            gap: 8px;
        }
        
        .btn {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            background: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            border-color: #1677ff;
            color: #1677ff;
        }
        
        .btn-icon {
            margin-right: 4px;
        }
        
        .btn-primary {
            background-color: #1677ff;
            border-color: #1677ff;
            color: #fff;
        }
        
        .btn-primary:hover {
            background-color: #4096ff;
            border-color: #4096ff;
        }
        
        .btn-primary:disabled {
            background-color: #d9d9d9;
            border-color: #d9d9d9;
            color: #fff;
            cursor: not-allowed;
        }
        
        .btn-danger {
            background-color: #ff4d4f;
            border-color: #ff4d4f;
            color: #fff;
        }
        
        .btn-danger:hover {
            background-color: #ff7875;
            border-color: #ff7875;
        }
        
        .table-wrapper {
            background-color: #fff;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .table-header {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #fafafa;
        }
        
        .table-actions {
            display: flex;
            gap: 8px;
        }
        
        .selected-info {
            color: #666;
            font-size: 14px;
        }
        
        .selected-count {
            color: #1677ff;
            font-weight: 500;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            text-align: left;
            padding: 12px 8px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            white-space: nowrap;
        }
        
        th {
            background-color: #fafafa;
            font-weight: 500;
            color: #666;
        }
        
        tbody tr:hover {
            background-color: #f5f5f5;
        }
        
        .checkbox {
            width: 16px;
            height: 16px;
            border: 1px solid #d9d9d9;
            border-radius: 2px;
            display: inline-block;
            cursor: pointer;
            position: relative;
        }
        
        .checkbox.checked {
            background-color: #1677ff;
            border-color: #1677ff;
        }
        
        .checkbox.checked::after {
            content: "âœ“";
            position: absolute;
            top: -2px;
            left: 2px;
            color: white;
            font-size: 12px;
        }
        
        .status-tag {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .status-tag.blue {
            background-color: #e6f7ff;
            color: #1677ff;
        }
        
        .status-tag.green {
            background-color: #f6ffed;
            color: #52c41a;
        }
        
        .status-tag.orange {
            background-color: #fff2e8;
            color: #fa8c16;
        }
        
        .status-tag.red {
            background-color: #fff2f0;
            color: #ff4d4f;
        }
        
        .status-tag.purple {
            background-color: #f9f0ff;
            color: #722ed1;
        }
        
        .action-btn {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            margin-right: 4px;
            background-color: #f0f7ff;
            color: #1677ff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .action-btn:hover {
            background-color: #e6f7ff;
        }
        
        .action-btn.danger {
            background-color: #fff2f0;
            color: #ff4d4f;
        }
        
        .action-btn.danger:hover {
            background-color: #ffece8;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border-radius: 8px;
            width: 500px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e8e8e8;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 16px;
            font-weight: 500;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 12px 20px;
            border-top: 1px solid #e8e8e8;
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }
        
        .btn-modal {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            background: #fff;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-modal.btn-primary {
            background-color: #1677ff;
            border-color: #1677ff;
            color: #fff;
        }
        
        .btn-modal.btn-secondary {
            color: #666;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            border-color: #1677ff;
        }
        
        /* Pagination styles */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            color: #666;
            font-size: 14px;
            background-color: #fff;
            border-top: 1px solid #f0f0f0;
        }
        
        .pagination-info {
            color: #999;
        }
        
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .page-btn {
            min-width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            cursor: pointer;
            background-color: #fff;
        }
        
        .page-btn.active {
            background-color: #1677ff;
            color: #fff;
            border-color: #1677ff;
        }
        
        .page-btn.disabled {
            color: #d9d9d9;
            cursor: not-allowed;
        }
        
        .per-page {
            display: flex;
            align-items: center;
            margin-left: 16px;
        }
        
        /* æ–°å¢ï¼šè´Ÿè´£äººå’Œå®¢æˆ·è¡Œæ ·å¼ */
        .staff-main-row {
            transition: background-color 0.3s;
        }
        
        .staff-main-row:hover {
            background-color: #f8f9fa !important;
        }
        
        .client-detail-row {
            transition: all 0.3s;
            animation: slideDown 0.3s ease-out;
        }
        
        .client-detail-row:hover {
            background-color: #f0f7ff !important;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* å±•å¼€å›¾æ ‡æ—‹è½¬åŠ¨ç”» */
        .expand-icon {
            transition: transform 0.3s ease;
        }
        
        .expand-icon.expanded {
            transform: rotate(90deg);
        }
        
        /* è§’è‰²æ ‡ç­¾æ ·å¼ */
        .role-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 12px;
            font-weight: 500;
        }
        
        /* å®¢æˆ·è¯¦æƒ…è¡Œçš„ç¼©è¿›æ•ˆæœ */
        .client-detail-row td:first-child {
            position: relative;
        }
        
        .client-detail-row td:first-child::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #e6f7ff;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <span class="logo-icon">ğŸ“‹</span>
            <span>èµ„æ–™ç®¡ç†ç³»ç»Ÿ</span>
        </div>
        <div class="header-right">
            <span class="header-icon">ğŸ””</span>
            <span class="header-icon">ğŸŒ™</span>
            <span class="header-icon">ğŸ”</span>
            <span class="header-icon">âš™ï¸</span>
            <div class="avatar">U</div>
        </div>
    </header>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="menu">
                <div class="menu-item" onclick="window.location.href='index.html'">
                    <span class="menu-icon">ğŸ </span>
                    <span>é¦–é¡µ</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ“‹</span>
                    <span>è®¢å•ç®¡ç†</span>
                    <span class="menu-arrow">â–¼</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ‘¤</span>
                    <span>å®¢æˆ·ç®¡ç†</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ‘¥</span>
                    <span>å®¢æˆ·ç¾¤ç®¡ç†</span>
                </div>
                <div class="menu-item" onclick="window.location.href='management.html'">
                    <span class="menu-icon">ğŸ“</span>
                    <span>èµ„æ–™åˆ¶ä½œåˆ—è¡¨</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ“</span>
                    <span>çŸ¥è¯†äº§æƒåˆ—è¡¨</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ“š</span>
                    <span>ç»§ç»­æ•™è‚²åˆ—è¡¨</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ“„</span>
                    <span>è®ºæ–‡åˆ—è¡¨</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ”„</span>
                    <span>å…±äº«ç›˜</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ“Š</span>
                    <span>æ”¿ç­–ç®¡ç†</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">ğŸ”‘</span>
                    <span>æƒé™ç®¡ç†</span>
                    <span class="menu-arrow">â–¼</span>
                </div>
                <div class="menu-item active">
                    <span class="menu-icon">ğŸ”„</span>
                    <span>å·¥ä½œäº¤æ¥</span>
                </div>
                <div class="menu-item">
                    <span class="menu-icon">âš™ï¸</span>
                    <span>è®¾ç½®</span>
                    <span class="menu-arrow">â–¼</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">å·¥ä½œäº¤æ¥</h1>
                <div class="breadcrumb">
                    <a href="index.html">é¦–é¡µ</a> / <a href="management.html">èµ„æ–™åˆ¶ä½œåˆ—è¡¨</a> / å·¥ä½œäº¤æ¥
                </div>
            </div>

            <div class="content-wrapper">
                <!-- Filter Bar -->
                <div class="filter-bar">
                    <div class="search-input">
                        <span>ğŸ‘¤</span>
                        <input type="text" placeholder="æœç´¢è´Ÿè´£äººå§“åæˆ–å®¢æˆ·å§“å" id="searchInput">
                        <span class="search-icon">ğŸ”</span>
                    </div>

                    <div class="select-wrapper" onclick="toggleDropdown('responsiblePersonDropdown')">
                        <span class="select-text" id="responsiblePersonText">å…¨éƒ¨è´Ÿè´£äºº</span>
                        <span class="select-arrow">â–¼</span>
                    </div>

                    <div class="select-wrapper" onclick="toggleDropdown('stageDropdown')">
                        <span class="select-text" id="stageText">å…¨éƒ¨é˜¶æ®µ</span>
                        <span class="select-arrow">â–¼</span>
                    </div>

                    <div class="select-wrapper" onclick="toggleDropdown('statusDropdown')">
                        <span class="select-text" id="statusText">å…¨éƒ¨çŠ¶æ€</span>
                        <span class="select-arrow">â–¼</span>
                    </div>

                    <div class="filter-actions">
                        <button class="btn" onclick="resetFilters()">
                            <span class="btn-icon">ğŸ”„</span>
                            <span>é‡ç½®</span>
                        </button>
                        <button class="btn" onclick="refreshTable()">
                            <span class="btn-icon">â†»</span>
                        </button>
                    </div>
                </div>

                <!-- Table -->
                <div class="table-wrapper">
                    <div class="table-header">
                        <div class="selected-info">
                            å·²é€‰æ‹© <span class="selected-count" id="selectedCount">0</span> é¡¹ï¼Œå…± <span id="totalCount">0</span> é¡¹
                        </div>
                        <div class="table-actions">
                         
                            <button class="btn btn-primary" onclick="openBatchHandoverModal()" id="batchHandoverBtn" disabled>
                                <span class="btn-icon">ğŸ”„</span>
                                æ‰¹é‡äº¤æ¥
                            </button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <div class="checkbox" id="selectAllCheckbox" onclick="toggleSelectAll()"></div>
                                </th>
                                <th style="width: 50px;">åºå·</th>
                                <th style="width: 120px;">è´Ÿè´£äººä¿¡æ¯</th>
                                <th style="width: 100px;">è´Ÿè´£å®¢æˆ·æ•°</th>
                                <th style="width: 140px;">å·¥ä½œçŠ¶æ€</th>
                                <th style="width: 80px;">äººå‘˜çŠ¶æ€</th>
                                <th style="width: 120px;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="clientTableBody">
                            <!-- è´Ÿè´£äººæ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                        </tbody>
                    </table>
                    <!-- Pagination -->
                    <div class="pagination">
                        <div class="pagination-info">å…± <span id="totalItems">0</span> æ¡</div>
                        <div class="pagination-controls">
                            <div class="page-btn active">1</div>
                            <div class="page-btn disabled">></div>
                            <div class="per-page">
                                <span>15 æ¡/é¡µ</span>
                                <span style="margin-left: 4px;">â–¼</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- å•ä¸ªäº¤æ¥æ¨¡æ€æ¡† -->
    <div class="modal" id="handoverModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">å·¥ä½œäº¤æ¥</div>
                <button class="modal-close" onclick="closeModal('handoverModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: #666;">
                    å®¢æˆ·ï¼š<span id="handoverCustomerName" style="font-weight: 500; color: #333;"></span><br>
                    å½“å‰è´Ÿè´£äººï¼š<span id="currentResponsible" style="font-weight: 500; color: #333;"></span>
                </p>
                <div class="form-group">
                    <label class="form-label">é€‰æ‹©æ–°è´Ÿè´£äºº <span style="color: #ff4d4f;">*</span></label>
                    <select class="form-control" id="newResponsibleSelect">
                        <!-- é€‰é¡¹å°†æ ¹æ®æƒé™åŠ¨æ€ç”Ÿæˆ -->
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">äº¤æ¥åŸå›  <span style="color: #ff4d4f;">*</span></label>
                    <select class="form-control" id="handoverReasonSelect">
                        <option value="">è¯·é€‰æ‹©äº¤æ¥åŸå› </option>
                        <option value="resignation">äººå‘˜ç¦»èŒ</option>
                        <option value="workload">å·¥ä½œé‡è°ƒæ•´</option>
                        <option value="other">å…¶ä»–åŸå› </option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                    <textarea class="form-control" id="handoverRemark" placeholder="è¯·è¾“å…¥äº¤æ¥å¤‡æ³¨..." rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-secondary" onclick="closeModal('handoverModal')">å–æ¶ˆ</button>
                <button class="btn-modal btn-primary" onclick="confirmHandover()">ç¡®è®¤äº¤æ¥</button>
            </div>
        </div>
    </div>

    <!-- æ‰¹é‡äº¤æ¥æ¨¡æ€æ¡† -->
    <div class="modal" id="batchHandoverModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">æ‰¹é‡å·¥ä½œäº¤æ¥</div>
                <button class="modal-close" onclick="closeModal('batchHandoverModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: #666;">
                    å°†è¦äº¤æ¥ <span class="selected-count" id="batchHandoverCount">0</span> ä½å®¢æˆ·çš„å·¥ä½œ
                </p>
                <div class="form-group">
                    <label class="form-label">é€‰æ‹©æ–°è´Ÿè´£äºº <span style="color: #ff4d4f;">*</span></label>
                    <select class="form-control" id="batchNewResponsibleSelect">
                        <!-- é€‰é¡¹å°†æ ¹æ®æƒé™åŠ¨æ€ç”Ÿæˆ -->
                    </select>
                    <div style="font-size: 12px; color: #999; margin-top: 4px;">
                        <span style="color: #fa8c16;">âš ï¸</span> æƒé™è¯´æ˜ï¼šäºŒçº§ç»„é•¿åªèƒ½äº¤æ¥ç»™åŒçº§æˆ–æ›´é«˜çº§åˆ«äººå‘˜ï¼ŒåŒé‡èº«ä»½äººå‘˜æ˜¾ç¤º ğŸ”„ æ ‡è¯†
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">äº¤æ¥åŸå›  <span style="color: #ff4d4f;">*</span></label>
                    <select class="form-control" id="batchHandoverReasonSelect">
                        <option value="">è¯·é€‰æ‹©äº¤æ¥åŸå› </option>
                        <option value="resignation">äººå‘˜ç¦»èŒ</option>
                        <option value="workload">å·¥ä½œé‡è°ƒæ•´</option>
                        <option value="other">å…¶ä»–åŸå› </option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">å¤‡æ³¨è¯´æ˜</label>
                    <textarea class="form-control" id="batchHandoverRemark" placeholder="è¯·è¾“å…¥äº¤æ¥å¤‡æ³¨..." rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-secondary" onclick="closeModal('batchHandoverModal')">å–æ¶ˆ</button>
                <button class="btn-modal btn-primary" onclick="confirmBatchHandover()">ç¡®è®¤æ‰¹é‡äº¤æ¥</button>
            </div>
        </div>
    </div>

    <!-- äº¤æ¥è®°å½•æ¨¡æ€æ¡† -->
    <div class="modal" id="handoverHistoryModal" style="z-index: 1001;">
        <div class="modal-content" style="width: 800px; max-width: 95vw;">
            <div class="modal-header">
                <div class="modal-title">äº¤æ¥è®°å½•</div>
                <button class="modal-close" onclick="closeModal('handoverHistoryModal')">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <!-- æœç´¢ç­›é€‰æ  -->
                <div style="padding: 16px; border-bottom: 1px solid #f0f0f0;">
                    <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; border: 1px solid #d9d9d9; border-radius: 4px; padding: 0 12px; height: 32px; width: 200px;">
                            <span>ğŸ‘¤</span>
                            <input type="text" placeholder="æœç´¢å®¢æˆ·å§“å" id="historySearchInput" style="border: none; outline: none; flex: 1; height: 100%; font-size: 14px;">
                        </div>
                        <select style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 6px 12px; font-size: 14px;" id="historyReasonFilter">
                            <option value="">å…¨éƒ¨åŸå› </option>
                            <option value="resignation">äººå‘˜ç¦»èŒ</option>
                            <option value="workload">å·¥ä½œé‡è°ƒæ•´</option>
                            <option value="other">å…¶ä»–åŸå› </option>
                        </select>
                        <input type="date" id="historyDateFrom" style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 6px 12px; font-size: 14px;">
                        <span>è‡³</span>
                        <input type="date" id="historyDateTo" style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 6px 12px; font-size: 14px;">
                        <button class="btn" onclick="filterHistoryRecords()" style="height: 32px; padding: 0 12px;">
                            <span>ğŸ”</span>
                            æœç´¢
                        </button>
                        <button class="btn" onclick="resetHistoryFilters()" style="height: 32px; padding: 0 12px;">
                            <span>ğŸ”„</span>
                            é‡ç½®
                        </button>
                    </div>
                </div>
                
                <!-- è®°å½•åˆ—è¡¨ -->
                <div style="max-height: 400px; overflow-y: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #fafafa;">
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">æ—¶é—´</th>
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">å®¢æˆ·</th>
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">åŸè´Ÿè´£äºº</th>
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">æ–°è´Ÿè´£äºº</th>
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">äº¤æ¥åŸå› </th>
                                <th style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px; font-weight: 500; color: #666;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- äº¤æ¥è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                        </tbody>
                    </table>
                </div>
                
                <!-- æ— æ•°æ®æç¤º -->
                <div id="noHistoryData" style="text-align: center; padding: 40px; color: #999; display: none;">
                    <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div>
                    <div>æš‚æ— äº¤æ¥è®°å½•</div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="flex: 1; color: #666; font-size: 14px;">
                    å…± <span id="historyTotalCount">0</span> æ¡è®°å½•
                </div>
                <button class="btn-modal btn-secondary" onclick="closeModal('handoverHistoryModal')">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- äº¤æ¥è®°å½•è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal" id="handoverDetailModal" style="z-index: 1002;">
        <div class="modal-content" style="width: 500px;">
            <div class="modal-header">
                <div class="modal-title">äº¤æ¥è®°å½•è¯¦æƒ…</div>
                <button class="modal-close" onclick="closeModal('handoverDetailModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 16px;">
                    <strong style="color: #333;">åŸºæœ¬ä¿¡æ¯</strong>
                </div>
                <div style="display: grid; grid-template-columns: 80px 1fr; gap: 12px; margin-bottom: 20px;">
                    <div style="color: #666;">å®¢æˆ·å§“å:</div>
                    <div id="detailCustomerName" style="font-weight: 500;"></div>
                    <div style="color: #666;">äº¤æ¥æ—¶é—´:</div>
                    <div id="detailHandoverTime"></div>
                    <div style="color: #666;">åŸè´Ÿè´£äºº:</div>
                    <div id="detailOldResponsible"></div>
                    <div style="color: #666;">æ–°è´Ÿè´£äºº:</div>
                    <div id="detailNewResponsible"></div>
                    <div style="color: #666;">äº¤æ¥åŸå› :</div>
                    <div id="detailReason"></div>
                </div>
                <div style="margin-bottom: 16px;">
                    <strong style="color: #333;">å¤‡æ³¨è¯´æ˜</strong>
                </div>
                <div style="background-color: #f8f9fa; padding: 12px; border-radius: 4px; min-height: 60px; color: #666;" id="detailRemark">
                    æ— å¤‡æ³¨
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-secondary" onclick="closeModal('handoverDetailModal')">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        // äººå‘˜è§’è‰²å®šä¹‰
        const ROLES = {
            'admin': { name: 'ç®¡ç†å‘˜', level: 100, color: '#722ed1' },
            'level1_leader': { name: 'ä¸€çº§ç»„é•¿', level: 90, color: '#fa8c16' },
            'level2_leader': { name: 'äºŒçº§ç»„é•¿', level: 80, color: '#1677ff' },
            'material_maker': { name: 'èµ„æ–™åˆ¶ä½œå‘˜', level: 60, color: '#52c41a' },
            'mail_specialist': { name: 'é‚®å¯„ä¸“å‘˜', level: 50, color: '#13c2c2' },
            'scan_specialist': { name: 'æ‰«æä¸“å‘˜', level: 40, color: '#eb2f96' }
        };

        // äººå‘˜æ•°æ® - æ”¯æŒå¤šé‡è§’è‰²
        const staffData = [
            { id: 'yangmiao', name: 'æ¨è‹—', roles: ['level2_leader'], status: 'active' },
            { id: 'xiangying', name: 'å‘è¹', roles: ['material_maker'], status: 'active' },
            { id: 'caojianhong', name: 'æ›¹å»ºçº¢', roles: ['material_maker'], status: 'active' },
            { id: 'zhangsan', name: 'å¼ ä¸‰', roles: ['material_maker'], status: 'active' },
            { id: 'zhaoliu', name: 'èµµå…­', roles: ['mail_specialist'], status: 'active' },
            { id: 'qianqi', name: 'é’±ä¸ƒ', roles: ['level1_leader', 'level2_leader'], status: 'active' }, // åŒé‡èº«ä»½
            { id: 'wushi', name: 'å´å', roles: ['scan_specialist'], status: 'active' },
            { id: 'sunyi', name: 'å­™ä¸€', roles: ['material_maker'], status: 'active' },
            { id: 'lihua', name: 'æå', roles: ['level1_leader', 'level2_leader'], status: 'active' } // åŒé‡èº«ä»½
        ];

        // é‡æ„å®¢æˆ·æ•°æ®ï¼Œæ·»åŠ è´Ÿè´£äººID
        let clientsData = [
            {
                id: 1,
                name: 'zzc009',
                profession: 'èˆ¹èˆ¶å·¥ç¨‹ä¸æ°´è¿å·¥ç¨‹',
                status: 'ã€äºŒçº§ç»„é•¿ã€‘ä¸šç»©æ¢³ç†',
                stage: 'ä¸šåŠ¡æ¢³ç†',
                responsibleId: 'yangmiao',
                responsible: 'æ¨è‹—',
                assignTime: '2025-01-15',
                statusClass: 'blue'
            },
            {
                id: 2,
                name: 'å‘¨è¹',
                profession: 'å»ºç­‘å·¥ç¨‹',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜+äºŒçº§ç»„é•¿ã€‘åˆå®¡',
                stage: 'èµ„æ–™åˆ¶ä½œ',
                responsibleId: 'xiangying',
                responsible: 'å‘è¹',
                assignTime: '2025-01-14',
                campus: 'äºŒåˆ†æ ¡',
                statusClass: 'green'
            },
            {
                id: 3,
                name: 'ly023',
                profession: 'æ¸¯å£ä¸èˆªé“å·¥ç¨‹',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜ã€‘è¿›åº¦äºŒè¿›è¡Œä¸­',
                stage: 'èµ„æ–™åˆ¶ä½œ',
                responsibleId: 'caojianhong',
                responsible: 'æ›¹å»ºçº¢',
                assignTime: '2025-01-13',
                statusClass: 'orange'
            },
            {
                id: 4,
                name: 'æå››',
                profession: 'è½¯ä»¶å·¥ç¨‹å¸ˆ',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜ã€‘èµ„æ–™å¾…æ ¸ç¨¿',
                stage: 'æ ¸ç¨¿ä¿®æ”¹',
                responsibleId: 'zhangsan',
                responsible: 'å¼ ä¸‰',
                assignTime: '2025-01-12',
                campus: 'æ€»æ ¡',
                statusClass: 'purple'
            },
            {
                id: 5,
                name: 'ç‹äº”',
                profession: 'ä¸­çº§ä¼šè®¡å¸ˆ',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜ã€‘é‚®å¯„å¾…åˆ†é…',
                stage: 'é‚®å¯„ç›–ç« ',
                responsibleId: 'zhaoliu',
                responsible: 'èµµå…­',
                assignTime: '2025-01-11',
                campus: 'ä¸‰åˆ†æ ¡',
                statusClass: 'red'
            },
            {
                id: 6,
                name: 'èµµå…­å®¢æˆ·',
                profession: 'é«˜çº§æ•™å¸ˆ',
                status: 'ã€é‚®å¯„å°ç»„ã€‘èµ„æ–™å¾…é‚®å¯„',
                stage: 'é‚®å¯„ç›–ç« ',
                responsibleId: 'qianqi',
                responsible: 'é’±ä¸ƒ',
                assignTime: '2025-01-10',
                campus: 'å››åˆ†æ ¡',
                statusClass: 'blue'
            },
            {
                id: 7,
                name: 'å‘¨ä¹',
                profession: 'é«˜çº§æ•™å¸ˆ',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜ã€‘æ‰«æå¾…åˆ†é…',
                stage: 'åŒç­¾æ‰«æ',
                responsibleId: 'wushi',
                responsible: 'å´å',
                assignTime: '2025-01-09',
                campus: 'å››åˆ†æ ¡',
                statusClass: 'red'
            },
            {
                id: 8,
                name: 'å´åå®¢æˆ·',
                profession: 'ä¸­çº§å·¥ç¨‹å¸ˆ',
                status: 'ã€æ‰«æå°ç»„ã€‘èµ„æ–™å¾…æ‰«æ',
                stage: 'åŒç­¾æ‰«æ',
                responsibleId: 'sunyi',
                responsible: 'å­™ä¸€',
                assignTime: '2025-01-08',
                campus: 'æ€»æ ¡',
                statusClass: 'blue'
            },
            {
                id: 9,
                name: 'å¼ ä¸‰å®¢æˆ·2',
                profession: 'ç½‘ç»œå·¥ç¨‹å¸ˆ',
                status: 'ã€èµ„æ–™åˆ¶ä½œå‘˜ã€‘å¾…æäº¤',
                stage: 'èµ„æ–™åˆ¶ä½œ',
                responsibleId: 'zhangsan',
                responsible: 'å¼ ä¸‰',
                assignTime: '2025-01-07',
                campus: 'æ€»æ ¡',
                statusClass: 'green'
            },
            {
                id: 10,
                name: 'æ¨è‹—å®¢æˆ·2',
                profession: 'æ°´åˆ©å·¥ç¨‹',
                status: 'ã€äºŒçº§ç»„é•¿ã€‘å®¡æ ¸ä¸­',
                stage: 'ä¸šåŠ¡æ¢³ç†',
                responsibleId: 'yangmiao',
                responsible: 'æ¨è‹—',
                assignTime: '2025-01-06',
                statusClass: 'orange'
            },
            {
                id: 11,
                name: 'é’±ä¸ƒå®¢æˆ·1',
                profession: 'ç”µæ°”å·¥ç¨‹å¸ˆ',
                status: 'ã€ä¸€çº§ç»„é•¿ã€‘ç»ˆå®¡',
                stage: 'ç»ˆå®¡é˜¶æ®µ',
                responsibleId: 'qianqi',
                responsible: 'é’±ä¸ƒ',
                assignTime: '2025-01-05',
                campus: 'æ€»æ ¡',
                statusClass: 'blue'
            },
            {
                id: 12,
                name: 'é’±ä¸ƒå®¢æˆ·2',
                profession: 'å»ºç­‘å·¥ç¨‹å¸ˆ',
                status: 'ã€äºŒçº§ç»„é•¿ã€‘å¤å®¡',
                stage: 'ä¸šåŠ¡æ¢³ç†',
                responsibleId: 'qianqi',
                responsible: 'é’±ä¸ƒ',
                assignTime: '2025-01-04',
                campus: 'äºŒåˆ†æ ¡',
                statusClass: 'green'
            }
        ];

        // äº¤æ¥è®°å½•æ•°æ®
        let handoverHistory = [
            {
                id: 1,
                clientId: 1,
                clientName: 'zzc009',
                oldResponsible: 'ææ˜',
                newResponsible: 'æ¨è‹—',
                reason: 'resignation',
                reasonText: 'äººå‘˜ç¦»èŒ',
                remark: 'ææ˜å› å·¥ä½œè°ƒåŠ¨ç¦»èŒï¼Œå°†å®¢æˆ·zzc009çš„ä¸šç»©æ¢³ç†å·¥ä½œäº¤æ¥ç»™æ¨è‹—ç»§ç»­è´Ÿè´£ã€‚',
                handoverTime: '2025-01-15 14:30:00',
                handoverBy: 'ç®¡ç†å‘˜'
            },
            {
                id: 2,
                clientId: 2,
                clientName: 'å‘¨è¹',
                oldResponsible: 'ç‹çº¢',
                newResponsible: 'å‘è¹',
                reason: 'workload',
                reasonText: 'å·¥ä½œé‡è°ƒæ•´',
                remark: 'ä¸ºå¹³è¡¡å·¥ä½œé‡ï¼Œå°†å‘¨è¹çš„èµ„æ–™åˆ¶ä½œå·¥ä½œä»ç‹çº¢äº¤æ¥ç»™å‘è¹ã€‚',
                handoverTime: '2025-01-14 10:15:00',
                handoverBy: 'ç®¡ç†å‘˜'
            }
        ];

        let selectedStaff = new Set();
        let selectedClients = new Set();
        let expandedStaff = new Set();
        let filteredStaffData = [];
        let filteredHistory = [...handoverHistory];

        // è·å–äººå‘˜çš„ä¸»è¦è§’è‰²ï¼ˆæœ€é«˜çº§åˆ«ï¼‰
        function getPrimaryRole(staff) {
            if (!staff.roles || staff.roles.length === 0) return 'material_maker';
            
            // æŒ‰æƒé™çº§åˆ«æ’åºï¼Œè¿”å›æœ€é«˜çº§åˆ«
            const sortedRoles = staff.roles.sort((a, b) => ROLES[b].level - ROLES[a].level);
            return sortedRoles[0];
        }

        // æ£€æŸ¥æ˜¯å¦ä¸ºåŒé‡èº«ä»½
        function isDualRole(staff) {
            return staff.roles && staff.roles.length > 1;
        }

        // è·å–è§’è‰²æ˜¾ç¤ºæ–‡æœ¬
        function getRoleDisplayText(staff) {
            if (!isDualRole(staff)) {
                const role = getPrimaryRole(staff);
                return ROLES[role].name;
            }
            
            // åŒé‡èº«ä»½æ˜¾ç¤º
            const roleNames = staff.roles.map(roleId => ROLES[roleId].name);
            return roleNames.join(' / ');
        }

        // è·å–è§’è‰²é¢œè‰²ï¼ˆåŒé‡èº«ä»½ä½¿ç”¨æ¸å˜è‰²ï¼‰
        function getRoleColor(staff) {
            if (!isDualRole(staff)) {
                const role = getPrimaryRole(staff);
                return ROLES[role].color;
            }
            
            // åŒé‡èº«ä»½ä½¿ç”¨ç‰¹æ®Šæ ‡è¯†è‰²
            return '#722ed1'; // ç´«è‰²è¡¨ç¤ºåŒé‡èº«ä»½
        }

        // æŒ‰è´Ÿè´£äººåˆ†ç»„å®¢æˆ·æ•°æ®
        function groupClientsByResponsible() {
            const staffMap = new Map();
            
            // åˆå§‹åŒ–æ‰€æœ‰å‘˜å·¥
            staffData.forEach(staff => {
                staffMap.set(staff.id, {
                    ...staff,
                    clients: [],
                    totalClients: 0,
                    activeClients: 0
                });
            });
            
            // åˆ†é…å®¢æˆ·åˆ°å¯¹åº”è´Ÿè´£äºº
            clientsData.forEach(client => {
                if (staffMap.has(client.responsibleId)) {
                    staffMap.get(client.responsibleId).clients.push(client);
                }
            });
            
            // è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
            staffMap.forEach(staff => {
                staff.totalClients = staff.clients.length;
                staff.activeClients = staff.clients.filter(c => 
                    c.statusClass === 'blue' || c.statusClass === 'green' || c.statusClass === 'orange'
                ).length;
            });
            
            return Array.from(staffMap.values()).filter(staff => staff.totalClients > 0);
        }

        // åˆå§‹åŒ–
        function init() {
            filteredStaffData = groupClientsByResponsible();
            renderTable();
            updateStats();
            // è®¾ç½®é»˜è®¤æ—¥æœŸèŒƒå›´ï¼ˆæœ€è¿‘30å¤©ï¼‰
            const today = new Date();
            const thirtyDaysAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
            document.getElementById('historyDateTo').value = today.toISOString().split('T')[0];
            document.getElementById('historyDateFrom').value = thirtyDaysAgo.toISOString().split('T')[0];
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const tbody = document.getElementById('clientTableBody');
            tbody.innerHTML = '';
            
            filteredStaffData.forEach((staff, index) => {
                // ä¸»è¡Œ - è´Ÿè´£äººä¿¡æ¯
                const mainRow = document.createElement('tr');
                mainRow.className = 'staff-main-row';
                mainRow.style.cursor = 'pointer';
                mainRow.style.backgroundColor = selectedStaff.has(staff.id) ? '#f0f7ff' : '';
                
                const roleInfo = ROLES[getPrimaryRole(staff)];
                const isExpanded = expandedStaff.has(staff.id);
                
                mainRow.innerHTML = `
                    <td>
                        <div class="checkbox ${selectedStaff.has(staff.id) ? 'checked' : ''}" 
                             onclick="event.stopPropagation(); toggleStaffSelection('${staff.id}')"></div>
                    </td>
                    <td>${index + 1}</td>
                    <td style="display: flex; align-items: center;">
                        <span style="margin-right: 8px; font-size: 16px; transition: transform 0.3s; transform: rotate(${isExpanded ? '90deg' : '0deg'});">â–¶</span>
                        <div>
                            <div style="font-weight: 500;">${staff.name}</div>
                            <div style="font-size: 12px; color: ${getRoleColor(staff)};">
                                <span style="background-color: ${getRoleColor(staff)}20; color: ${getRoleColor(staff)}; padding: 2px 6px; border-radius: 2px;">
                                    ${getRoleDisplayText(staff)}
                                </span>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #1677ff; font-weight: 500;">${staff.totalClients}</span>
                            <span style="color: #999;">ä¸ªå®¢æˆ·</span>
                        </div>
                    </td>
                    <td>
                        <div style="display: flex; gap: 4px;">
                            <span style="background-color: #f6ffed; color: #52c41a; padding: 2px 6px; border-radius: 2px; font-size: 12px;">
                                è¿›è¡Œä¸­: ${staff.activeClients}
                            </span>
                            ${staff.totalClients - staff.activeClients > 0 ? `
                                <span style="background-color: #fff2f0; color: #ff4d4f; padding: 2px 6px; border-radius: 2px; font-size: 12px;">
                                    å¾…å¤„ç†: ${staff.totalClients - staff.activeClients}
                                </span>
                            ` : ''}
                        </div>
                    </td>
                    <td>
                        <span style="background-color: #f6ffed; color: #52c41a; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                            ${staff.status === 'active' ? 'åœ¨èŒ' : 'ç¦»èŒ'}
                        </span>
                    </td>
                    <td>
                        <span class="action-btn" onclick="event.stopPropagation(); handoverStaff('${staff.id}')">
                            <span style="margin-right: 4px;">ğŸ”„</span>
                            äº¤æ¥
                        </span>
                        <span class="action-btn" onclick="event.stopPropagation(); viewStaffHistory('${staff.id}')">
                            <span style="margin-right: 4px;">ğŸ“‹</span>
                            è®°å½•
                        </span>
                    </td>
                `;
                
                mainRow.addEventListener('click', () => toggleExpandStaff(staff.id));
                tbody.appendChild(mainRow);
                
                // å­è¡Œ - å®¢æˆ·è¯¦æƒ…
                if (isExpanded) {
                    staff.clients.forEach((client, clientIndex) => {
                        const clientRow = document.createElement('tr');
                        clientRow.className = 'client-detail-row';
                        clientRow.style.backgroundColor = '#fafafa';
                        clientRow.style.borderLeft = '3px solid #1677ff';
                        
                        clientRow.innerHTML = `
                            <td style="padding-left: 20px;">
                                <div class="checkbox ${selectedClients.has(client.id) ? 'checked' : ''}" 
                                     onclick="toggleClientSelection(${client.id})"></div>
                            </td>
                            <td style="color: #999; font-size: 12px;">${index + 1}.${clientIndex + 1}</td>
                            <td style="padding-left: 20px;">
                                <div style="font-size: 14px;">${client.name}</div>
                            </td>
                            <td title="${client.profession}" style="font-size: 13px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;">
                                ${client.profession}
                            </td>
                            <td>
                                <span class="status-tag ${client.statusClass}" title="${client.status}" style="font-size: 12px;">
                                    ${client.status}
                                </span>
                            </td>
                            <td style="font-size: 13px;">${client.stage}</td>
                        `;
                        
                        tbody.appendChild(clientRow);
                    });
                }
            });
        }

        // åˆ‡æ¢è´Ÿè´£äººå±•å¼€çŠ¶æ€
        function toggleExpandStaff(staffId) {
            if (expandedStaff.has(staffId)) {
                expandedStaff.delete(staffId);
            } else {
                expandedStaff.add(staffId);
            }
            renderTable();
        }

        // åˆ‡æ¢è´Ÿè´£äººé€‰æ‹©
        function toggleStaffSelection(staffId) {
            if (selectedStaff.has(staffId)) {
                selectedStaff.delete(staffId);
                // å–æ¶ˆé€‰æ‹©è¯¥è´Ÿè´£äººçš„æ‰€æœ‰å®¢æˆ·
                const staff = filteredStaffData.find(s => s.id === staffId);
                if (staff) {
                    staff.clients.forEach(client => selectedClients.delete(client.id));
                }
            } else {
                selectedStaff.add(staffId);
                // è‡ªåŠ¨é€‰æ‹©è¯¥è´Ÿè´£äººçš„æ‰€æœ‰å®¢æˆ·
                const staff = filteredStaffData.find(s => s.id === staffId);
                if (staff) {
                    staff.clients.forEach(client => selectedClients.add(client.id));
                }
            }
            renderTable();
            updateStats();
        }

        // åˆ‡æ¢å®¢æˆ·é€‰æ‹©
        function toggleClientSelection(clientId) {
            if (selectedClients.has(clientId)) {
                selectedClients.delete(clientId);
            } else {
                selectedClients.add(clientId);
            }
            renderTable();
            updateStats();
        }

        // å…¨é€‰/å–æ¶ˆå…¨é€‰
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            
            if (selectedStaff.size === filteredStaffData.length && filteredStaffData.length > 0) {
                // å½“å‰å…¨é€‰ï¼Œæ‰§è¡Œå–æ¶ˆå…¨é€‰
                selectedStaff.clear();
                selectedClients.clear();
                selectAllCheckbox.classList.remove('checked');
            } else {
                // æ‰§è¡Œå…¨é€‰
                selectedStaff.clear();
                selectedClients.clear();
                filteredStaffData.forEach(staff => {
                    selectedStaff.add(staff.id);
                    staff.clients.forEach(client => selectedClients.add(client.id));
                });
                selectAllCheckbox.classList.add('checked');
            }
            
            renderTable();
            updateStats();
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const totalClients = filteredStaffData.reduce((sum, staff) => sum + staff.totalClients, 0);
            document.getElementById('selectedCount').textContent = selectedClients.size;
            document.getElementById('totalCount').textContent = totalClients;
            document.getElementById('totalItems').textContent = totalClients;
            
            // æ›´æ–°æ‰¹é‡äº¤æ¥æŒ‰é’®çŠ¶æ€
            const batchBtn = document.getElementById('batchHandoverBtn');
            batchBtn.disabled = selectedClients.size === 0;
            
            // æ›´æ–°å…¨é€‰å¤é€‰æ¡†çŠ¶æ€
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            if (selectedStaff.size === filteredStaffData.length && filteredStaffData.length > 0) {
                selectAllCheckbox.classList.add('checked');
            } else {
                selectAllCheckbox.classList.remove('checked');
            }
        }

        // è´Ÿè´£äººäº¤æ¥
        function handoverStaff(staffId) {
            const staff = filteredStaffData.find(s => s.id === staffId);
            if (!staff) return;
            
            // è‡ªåŠ¨é€‰æ‹©è¯¥è´Ÿè´£äººçš„æ‰€æœ‰å®¢æˆ·
            selectedClients.clear();
            staff.clients.forEach(client => selectedClients.add(client.id));
            
            document.getElementById('batchHandoverCount').textContent = staff.clients.length;
            document.getElementById('batchNewResponsibleSelect').innerHTML = generateResponsibleOptions(staff.roles);
            document.getElementById('batchHandoverReasonSelect').value = '';
            
            // æ ¹æ®æ˜¯å¦ä¸ºåŒé‡èº«ä»½è®¾ç½®ä¸åŒçš„å¤‡æ³¨
            if (isDualRole(staff)) {
                document.getElementById('batchHandoverRemark').value = `${staff.name}ï¼ˆ${getRoleDisplayText(staff)}ï¼‰è´Ÿè´£çš„æ‰€æœ‰å®¢æˆ·å·¥ä½œäº¤æ¥ - æ³¨æ„ï¼šè¯¥äººå‘˜å…·æœ‰åŒé‡èº«ä»½ï¼Œè¯·ç¡®è®¤äº¤æ¥æƒé™`;
                
                // æ˜¾ç¤ºåŒé‡èº«ä»½ç‰¹æ®Šæç¤º
                showDualRoleWarning(staff);
            } else {
                document.getElementById('batchHandoverRemark').value = `${staff.name}è´Ÿè´£çš„æ‰€æœ‰å®¢æˆ·å·¥ä½œäº¤æ¥`;
            }
            
            // å­˜å‚¨å½“å‰æ“ä½œçš„è´Ÿè´£äººID
            document.getElementById('batchHandoverModal').dataset.staffId = staffId;
            document.getElementById('batchHandoverModal').style.display = 'block';
        }

        // æ˜¾ç¤ºåŒé‡èº«ä»½è­¦å‘Š
        function showDualRoleWarning(staff) {
            const modalBody = document.querySelector('#batchHandoverModal .modal-body');
            
            // ç§»é™¤ä¹‹å‰çš„è­¦å‘Šï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            const existingWarning = modalBody.querySelector('.dual-role-warning');
            if (existingWarning) {
                existingWarning.remove();
            }
            
            // åˆ›å»ºåŒé‡èº«ä»½è­¦å‘Šæ¡†
            const warningDiv = document.createElement('div');
            warningDiv.className = 'dual-role-warning';
            warningDiv.style.cssText = `
                background-color: #fff7e6;
                border: 1px solid #ffd591;
                border-radius: 4px;
                padding: 12px;
                margin-bottom: 16px;
                font-size: 14px;
            `;
            
            const rolesList = staff.roles.map(roleId => ROLES[roleId].name).join('ã€');
            
            warningDiv.innerHTML = `
                <div style="display: flex; align-items: flex-start; gap: 8px;">
                    <span style="color: #fa8c16; font-size: 16px;">âš ï¸</span>
                    <div>
                        <div style="font-weight: 500; color: #fa8c16; margin-bottom: 8px;">
                            åŒé‡èº«ä»½äººå‘˜äº¤æ¥æé†’
                        </div>
                        <div style="color: #666; line-height: 1.5;">
                            <p><strong>${staff.name}</strong> åœ¨ç³»ç»Ÿä¸­æ‹¥æœ‰åŒé‡èº«ä»½ï¼š<strong>${rolesList}</strong></p>
                            <p style="margin: 8px 0;">â€¢ è¯¥äººå‘˜å¯èƒ½åŒæ—¶è´Ÿè´£ä¸åŒå±‚çº§çš„å·¥ä½œ</p>
                            <p style="margin: 8px 0;">â€¢ äº¤æ¥æ—¶è¯·ç¡®è®¤æ¥æ”¶äººå…·å¤‡ç›¸åº”çš„æƒé™çº§åˆ«</p>
                            <p style="margin: 8px 0;">â€¢ å»ºè®®æŒ‰æœ€é«˜æƒé™çº§åˆ«ï¼ˆ${ROLES[getPrimaryRole(staff)].name}ï¼‰è¿›è¡Œäº¤æ¥</p>
                        </div>
                    </div>
                </div>
            `;
            
            // æ’å…¥åˆ°æ¨¡æ€æ¡†é¡¶éƒ¨
            modalBody.insertBefore(warningDiv, modalBody.firstChild);
        }

        // æ ¹æ®è§’è‰²ç”Ÿæˆå¯é€‰è´Ÿè´£äººé€‰é¡¹
        function generateResponsibleOptions(roles) {
            let options = '<option value="">è¯·é€‰æ‹©æ–°è´Ÿè´£äºº</option>';
            
            // è·å–å½“å‰è§’è‰²çš„æœ€é«˜æƒé™çº§åˆ«
            const maxLevel = Math.max(...roles.map(roleId => ROLES[roleId].level));
            const hasLevel2Leader = roles.includes('level2_leader');
            
            staffData.forEach(staff => {
                const staffRoles = staff.roles;
                const staffMaxLevel = Math.max(...staffRoles.map(roleId => ROLES[roleId].level));
                const roleDisplayText = getRoleDisplayText(staff);
                
                // æƒé™æ§åˆ¶é€»è¾‘
                let canTransfer = true;
                let warningText = '';
                
                // å¦‚æœåŸè´Ÿè´£äººæ˜¯äºŒçº§ç»„é•¿ï¼Œæ–°è´Ÿè´£äººå¿…é¡»æ˜¯äºŒçº§ç»„é•¿æˆ–æ›´é«˜çº§åˆ«
                if (hasLevel2Leader) {
                    const hasLevel2OrHigher = staffRoles.includes('level2_leader') || 
                                             staffRoles.includes('level1_leader') || 
                                             staffRoles.includes('admin');
                    if (!hasLevel2OrHigher) {
                        canTransfer = false;
                    }
                }
                
                // ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–°è´Ÿè´£äººçº§åˆ«ä¸èƒ½ä½äºåŸè´Ÿè´£äºº
                if (canTransfer && staffMaxLevel < maxLevel) {
                    canTransfer = false;
                }
                
                if (canTransfer) {
                    // ä¸ºåŒé‡èº«ä»½äººå‘˜æ·»åŠ ç‰¹æ®Šæ ‡è¯†
                    const dualRoleIndicator = isDualRole(staff) ? ' ğŸ”„' : '';
                    options += `<option value="${staff.id}">${staff.name} - ${roleDisplayText}${dualRoleIndicator}</option>`;
                }
            });
            
            return options;
        }

        // æ‰¹é‡äº¤æ¥
        function openBatchHandoverModal() {
            if (selectedClients.size === 0) {
                alert('è¯·å…ˆé€‰æ‹©è¦äº¤æ¥çš„å®¢æˆ·');
                return;
            }
            
            document.getElementById('batchHandoverCount').textContent = selectedClients.size;
            document.getElementById('batchNewResponsibleSelect').innerHTML = generateResponsibleOptions(['material_maker']); // é»˜è®¤æƒé™
            document.getElementById('batchHandoverReasonSelect').value = '';
            document.getElementById('batchHandoverRemark').value = '';
            
            document.getElementById('batchHandoverModal').style.display = 'block';
        }

        // ç¡®è®¤æ‰¹é‡äº¤æ¥
        function confirmBatchHandover() {
            const newResponsibleId = document.getElementById('batchNewResponsibleSelect').value;
            const reason = document.getElementById('batchHandoverReasonSelect').value;
            const remark = document.getElementById('batchHandoverRemark').value;
            
            if (!newResponsibleId) {
                alert('è¯·é€‰æ‹©æ–°è´Ÿè´£äºº');
                return;
            }
            
            if (!reason) {
                alert('è¯·é€‰æ‹©äº¤æ¥åŸå› ');
                return;
            }
            
            const newResponsible = staffData.find(s => s.id === newResponsibleId);
            const handoverCount = selectedClients.size;
            const handoverList = [];
            
            const reasonTexts = {
                'resignation': 'äººå‘˜ç¦»èŒ',
                'workload': 'å·¥ä½œé‡è°ƒæ•´',
                'other': 'å…¶ä»–åŸå› '
            };
            
            // æ›´æ–°æ‰€æœ‰é€‰ä¸­å®¢æˆ·çš„æ•°æ®
            selectedClients.forEach(clientId => {
                const client = clientsData.find(c => c.id === clientId);
                if (client) {
                    const oldResponsible = client.responsible;
                    client.responsibleId = newResponsibleId;
                    client.responsible = newResponsible.name;
                    client.assignTime = new Date().toISOString().split('T')[0];
                    
                    // æ·»åŠ äº¤æ¥è®°å½•
                    const newRecord = {
                        id: handoverHistory.length + handoverList.length + 1,
                        clientId: clientId,
                        clientName: client.name,
                        oldResponsible: oldResponsible,
                        newResponsible: newResponsible.name,
                        reason: reason,
                        reasonText: reasonTexts[reason] || reason,
                        remark: remark || 'æ‰¹é‡äº¤æ¥ï¼Œæ— ç‰¹åˆ«å¤‡æ³¨',
                        handoverTime: new Date().toISOString().replace('T', ' ').split('.')[0],
                        handoverBy: 'ç®¡ç†å‘˜'
                    };
                    
                    handoverList.push(newRecord);
                }
            });
            
            // å°†æ–°è®°å½•æ·»åŠ åˆ°å†å²è®°å½•å¼€å¤´
            handoverHistory.unshift(...handoverList);
            filteredHistory = [...handoverHistory];
            
            // é‡æ–°åˆ†ç»„æ•°æ®
            filteredStaffData = groupClientsByResponsible();
            selectedStaff.clear();
            selectedClients.clear();
            expandedStaff.clear();
            renderTable();
            updateStats();
            closeModal('batchHandoverModal');
            
            alert(`å·²æˆåŠŸå°† ${handoverCount} ä½å®¢æˆ·çš„å·¥ä½œäº¤æ¥ç»™ ${newResponsible.name}`);
        }

        // æœç´¢åŠŸèƒ½
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const allStaffData = groupClientsByResponsible();
            
            filteredStaffData = allStaffData.filter(staff => {
                // æœç´¢è´Ÿè´£äººå§“å
                const nameMatch = staff.name.toLowerCase().includes(searchTerm);
                
                // æœç´¢å®¢æˆ·å§“åæˆ–ä¸“ä¸š
                const clientMatch = staff.clients.some(client => 
                    client.name.toLowerCase().includes(searchTerm) ||
                    client.profession.toLowerCase().includes(searchTerm)
                );
                
                return nameMatch || clientMatch;
            });
            
            // æ¸…é™¤ä¸åœ¨ç­›é€‰ç»“æœä¸­çš„é€‰æ‹©
            const filteredStaffIds = new Set(filteredStaffData.map(s => s.id));
            selectedStaff.forEach(id => {
                if (!filteredStaffIds.has(id)) {
                    selectedStaff.delete(id);
                }
            });
            
            const filteredClientIds = new Set();
            filteredStaffData.forEach(staff => {
                staff.clients.forEach(client => filteredClientIds.add(client.id));
            });
            selectedClients.forEach(id => {
                if (!filteredClientIds.has(id)) {
                    selectedClients.delete(id);
                }
            });
            
            renderTable();
            updateStats();
        });

        // é‡ç½®ç­›é€‰
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('responsiblePersonText').textContent = 'å…¨éƒ¨è´Ÿè´£äºº';
            document.getElementById('stageText').textContent = 'å…¨éƒ¨é˜¶æ®µ';
            document.getElementById('statusText').textContent = 'å…¨éƒ¨çŠ¶æ€';
            
            filteredStaffData = groupClientsByResponsible();
            selectedStaff.clear();
            selectedClients.clear();
            expandedStaff.clear();
            renderTable();
            updateStats();
        }

        // åˆ·æ–°è¡¨æ ¼
        function refreshTable() {
            filteredStaffData = groupClientsByResponsible();
            selectedStaff.clear();
            selectedClients.clear();
            expandedStaff.clear();
            renderTable();
            updateStats();
            alert('æ•°æ®å·²åˆ·æ–°');
        }

        // æŸ¥çœ‹è´Ÿè´£äººå†å²è®°å½•
        function viewStaffHistory(staffId) {
            const staff = staffData.find(s => s.id === staffId);
            if (staff) {
                // ç­›é€‰å‡ºè¯¥è´Ÿè´£äººç›¸å…³çš„äº¤æ¥è®°å½•
                filteredHistory = handoverHistory.filter(record => 
                    record.oldResponsible === staff.name || record.newResponsible === staff.name
                );
                renderHistoryTable();
                document.getElementById('handoverHistoryModal').style.display = 'block';
                
                // å¦‚æœæœ‰è®°å½•ï¼Œæ˜¾ç¤ºè´Ÿè´£äººåç§°
                if (filteredHistory.length > 0) {
                    document.getElementById('historySearchInput').value = staff.name;
                }
            }
        }

        // æ¸²æŸ“äº¤æ¥è®°å½•è¡¨æ ¼
        function renderHistoryTable() {
            const tbody = document.getElementById('historyTableBody');
            const noDataDiv = document.getElementById('noHistoryData');
            
            tbody.innerHTML = '';
            
            if (filteredHistory.length === 0) {
                noDataDiv.style.display = 'block';
                document.getElementById('historyTotalCount').textContent = '0';
                return;
            }
            
            noDataDiv.style.display = 'none';
            
            filteredHistory.forEach((record) => {
                const row = document.createElement('tr');
                const handoverDate = new Date(record.handoverTime);
                const formattedDate = handoverDate.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                row.innerHTML = `
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">${formattedDate}</td>
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">${record.clientName}</td>
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">${record.oldResponsible}</td>
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">${record.newResponsible}</td>
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">${record.reasonText}</td>
                    <td style="padding: 12px 8px; border-bottom: 1px solid #f0f0f0; font-size: 14px;">
                        <span class="action-btn" onclick="viewHandoverDetail(${record.id})" style="margin: 0;">
                            <span style="margin-right: 4px;">ğŸ‘ï¸</span>
                            è¯¦æƒ…
                        </span>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            document.getElementById('historyTotalCount').textContent = filteredHistory.length;
        }

        // æŸ¥çœ‹äº¤æ¥è®°å½•
        function viewHandoverHistory() {
            filteredHistory = [...handoverHistory];
            renderHistoryTable();
            document.getElementById('handoverHistoryModal').style.display = 'block';
        }

        // ç­›é€‰äº¤æ¥è®°å½•
        function filterHistoryRecords() {
            const searchTerm = document.getElementById('historySearchInput').value.toLowerCase();
            const reasonFilter = document.getElementById('historyReasonFilter').value;
            const dateFrom = document.getElementById('historyDateFrom').value;
            const dateTo = document.getElementById('historyDateTo').value;
            
            filteredHistory = handoverHistory.filter(record => {
                // æœç´¢å®¢æˆ·åç§°æˆ–è´Ÿè´£äººåç§°
                const nameMatch = !searchTerm || 
                    record.clientName.toLowerCase().includes(searchTerm) ||
                    record.oldResponsible.toLowerCase().includes(searchTerm) ||
                    record.newResponsible.toLowerCase().includes(searchTerm);
                
                // ç­›é€‰åŸå› 
                const reasonMatch = !reasonFilter || record.reason === reasonFilter;
                
                // æ—¥æœŸèŒƒå›´ç­›é€‰
                let dateMatch = true;
                if (dateFrom || dateTo) {
                    const recordDate = new Date(record.handoverTime).toISOString().split('T')[0];
                    if (dateFrom && recordDate < dateFrom) dateMatch = false;
                    if (dateTo && recordDate > dateTo) dateMatch = false;
                }
                
                return nameMatch && reasonMatch && dateMatch;
            });
            
            renderHistoryTable();
        }

        // é‡ç½®äº¤æ¥è®°å½•ç­›é€‰
        function resetHistoryFilters() {
            document.getElementById('historySearchInput').value = '';
            document.getElementById('historyReasonFilter').value = '';
            document.getElementById('historyDateFrom').value = '';
            document.getElementById('historyDateTo').value = '';
            
            filteredHistory = [...handoverHistory];
            renderHistoryTable();
        }

        // æŸ¥çœ‹äº¤æ¥è¯¦æƒ…
        function viewHandoverDetail(recordId) {
            const record = handoverHistory.find(r => r.id === recordId);
            if (!record) return;
            
            document.getElementById('detailCustomerName').textContent = record.clientName;
            document.getElementById('detailHandoverTime').textContent = new Date(record.handoverTime).toLocaleString('zh-CN');
            document.getElementById('detailOldResponsible').textContent = record.oldResponsible;
            document.getElementById('detailNewResponsible').textContent = record.newResponsible;
            document.getElementById('detailReason').textContent = record.reasonText;
            document.getElementById('detailRemark').textContent = record.remark || 'æ— å¤‡æ³¨';
            
            document.getElementById('handoverDetailModal').style.display = 'block';
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            // æ¸…ç†åŒé‡èº«ä»½è­¦å‘Š
            if (modalId === 'batchHandoverModal') {
                const modalBody = document.querySelector('#batchHandoverModal .modal-body');
                const existingWarning = modalBody.querySelector('.dual-role-warning');
                if (existingWarning) {
                    existingWarning.remove();
                }
            }
            
            document.getElementById(modalId).style.display = 'none';
        }

        // ä¸‹æ‹‰æ¡†åˆ‡æ¢ï¼ˆå ä½ç¬¦å‡½æ•°ï¼‰
        function toggleDropdown(dropdownId) {
            console.log('åˆ‡æ¢ä¸‹æ‹‰æ¡†:', dropdownId);
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.addEventListener('click', function(e) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // å•ä¸ªå®¢æˆ·äº¤æ¥ï¼ˆä»å±•å¼€çš„å®¢æˆ·åˆ—è¡¨ä¸­ï¼‰
        function handoverSingle(clientId) {
            const client = clientsData.find(c => c.id === clientId);
            if (!client) return;
            
            // è·å–å½“å‰è´Ÿè´£äººä¿¡æ¯ï¼Œç”¨äºæƒé™æ§åˆ¶
            const currentStaff = staffData.find(s => s.id === client.responsibleId);
            const currentRoles = currentStaff ? currentStaff.roles : ['material_maker'];
            
            document.getElementById('handoverCustomerName').textContent = client.name;
            document.getElementById('currentResponsible').textContent = client.responsible;
            document.getElementById('newResponsibleSelect').innerHTML = generateResponsibleOptions(currentRoles);
            document.getElementById('handoverReasonSelect').value = '';
            document.getElementById('handoverRemark').value = '';
            
            // å­˜å‚¨å½“å‰æ“ä½œçš„å®¢æˆ·ID
            document.getElementById('handoverModal').dataset.clientId = clientId;
            document.getElementById('handoverModal').style.display = 'block';
        }

        // ç¡®è®¤å•ä¸ªäº¤æ¥
        function confirmHandover() {
            const clientId = parseInt(document.getElementById('handoverModal').dataset.clientId);
            const newResponsibleId = document.getElementById('newResponsibleSelect').value;
            const reason = document.getElementById('handoverReasonSelect').value;
            const remark = document.getElementById('handoverRemark').value;
            
            if (!newResponsibleId) {
                alert('è¯·é€‰æ‹©æ–°è´Ÿè´£äºº');
                return;
            }
            
            if (!reason) {
                alert('è¯·é€‰æ‹©äº¤æ¥åŸå› ');
                return;
            }
            
            // æ›´æ–°å®¢æˆ·æ•°æ®
            const client = clientsData.find(c => c.id === clientId);
            const newResponsible = staffData.find(s => s.id === newResponsibleId);
            
            if (client && newResponsible) {
                const oldResponsible = client.responsible;
                
                client.responsibleId = newResponsibleId;
                client.responsible = newResponsible.name;
                client.assignTime = new Date().toISOString().split('T')[0];
                
                // æ·»åŠ äº¤æ¥è®°å½•
                const reasonTexts = {
                    'resignation': 'äººå‘˜ç¦»èŒ',
                    'workload': 'å·¥ä½œé‡è°ƒæ•´',
                    'other': 'å…¶ä»–åŸå› '
                };
                
                const newRecord = {
                    id: handoverHistory.length + 1,
                    clientId: clientId,
                    clientName: client.name,
                    oldResponsible: oldResponsible,
                    newResponsible: newResponsible.name,
                    reason: reason,
                    reasonText: reasonTexts[reason] || reason,
                    remark: remark || 'æ— å¤‡æ³¨',
                    handoverTime: new Date().toISOString().replace('T', ' ').split('.')[0],
                    handoverBy: 'ç®¡ç†å‘˜'
                };
                
                handoverHistory.unshift(newRecord);
                filteredHistory = [...handoverHistory];
                
                // é‡æ–°åˆ†ç»„æ•°æ®
                filteredStaffData = groupClientsByResponsible();
                renderTable();
                updateStats();
                closeModal('handoverModal');
                
                alert(`å®¢æˆ· ${client.name} å·²æˆåŠŸäº¤æ¥ç»™ ${newResponsible.name}`);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html> 